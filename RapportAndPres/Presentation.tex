\documentclass{article}
\usepackage[backend=biber, style=authoryear, sorting=nyt, style=numeric]{biblatex}
\usepackage{url}
\usepackage[dvipsnames]{xcolor}
\usepackage{enumitem}

\usepackage{background}
\usepackage{tikz}
\usepackage{geometry}
\usetikzlibrary{shapes, arrows, positioning}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[british]{babel}
\usepackage{titletoc}
\usepackage{titlesec}
\usepackage{lipsum}
\usepackage{tocloft}
\usepackage{hyperref}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{graphicx}
\usepackage[section]{placeins}
\usepackage{caption}
\usepackage{textcomp}
\usepackage{subcaption}
\usepackage[edges]{forest}
%\usepackage[superscript,biblabel]{cite}
\usepackage{fontawesome5}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{amsmath}
\usepackage[simplified]{pgf-umlcd}
\usepackage{enumitem}
\usepackage{adjustbox}
\usepackage{listings}
\usetikzlibrary{shapes.geometric, arrows}
%\usepackage[style=ext-authoryear, backend=biber]{biblatex}
%\usepackage{url}
%\usepackage[style=authoryear]{biblatex}
\addbibresource{rapport.bib}
%\usepackage{cite}
\usepackage[british]{datetime2} % Enhanced date and time.

\addbibresource{rapport.bib}

\definecolor{aerospaceblue}{RGB}{0, 128, 255} % Couleur bleu ciel pour l'aérospatiale
\definecolor{myblue}{RGB}{0, 0, 255}

% Define the theme colors
\definecolor{blue}{RGB}{0,0,255}
\definecolor{green}{RGB}{0,128,0}
\definecolor{red}{RGB}{255,0,0}
\definecolor{custompurple}{RGB}{128,0,128}

% Set the lstset configuration
\lstset{
	language=C++,
	basicstyle=\ttfamily\small,
	keywordstyle=[1]\color{blue},
	keywordstyle=[2]\color{black},
	keywordstyle=[3]\color{green!60!black},
	commentstyle=\color{green!60!black},
	stringstyle=\color{red},
	otherkeywords={CALL},
	morekeywords=[1]{CALL},
	morekeywords=[2]{FOPENSUBNODES},
	numbers=left,
	numberstyle=\tiny,
	stepnumber=1,
	numbersep=5pt,
	frame=single,
	breaklines=true,
	breakatwhitespace=true,
	tabsize=4,
	captionpos=b,
	showstringspaces=false,
	% Adjust the frame margins for a larger rectangle
	xleftmargin=1em,
	framexleftmargin=1em,
	framexrightmargin=1em
}


\tikzset{
	startstop/.style={
		rectangle,
		rounded corners,
		minimum width=3cm,
		minimum height=1cm,
		text centered,
		draw=black,
		fill=red!30
	},
	io/.style={
		trapezium,
		trapezium stretches=true, % A later addition
		trapezium left angle=70,
		trapezium right angle=110,
		minimum width=3cm,
		minimum height=1cm,
		text centered,
		draw=black,
		fill=blue!30
	},
	process/.style={
		rectangle,
		minimum width=3cm,
		minimum height=1cm,
		text centered,
		text width=3cm,
		draw=black,
		fill=orange!30
	},
	decision/.style={
		diamond,
		minimum width=3cm,
		minimum height=1cm,
		text centered,
		draw=black,
		fill=green!30
	},
	arrow/.style={
		thick,
		->,
		>=stealth
	}
}

\newcommand{\coloredsquare}[1]{\textcolor{#1}{\rule{1em}{1em}}}

\renewcommand{\cfttoctitlefont}{\hfill\large\bfseries\fontsize{20}{24}\selectfont}
\renewcommand{\cftaftertoctitle}{\hfill\mbox{}}

\definecolor{mydarkyellow}{RGB}{105, 105, 105}
\definecolor{lightblue}{RGB}{173,216,230}
\definecolor{lightyellow}{RGB}{255,255,204}
\definecolor{yellow}{RGB}{255,255,0}

\backgroundsetup{
	scale=1,
	color=black,
	opacity=0.5,
	angle=0,
	contents={
		\ifnum\value{page}=1
		\begin{tikzpicture}[remember picture,overlay]
			\path [fill=mydarkyellow] (current page.south west) rectangle (current page.north east);
		\end{tikzpicture}
		\fi
	}
}

\title{\textbf{\Huge Project Report}\\[1cm]
	\textbf{\LARGE Polytech Nice}\\[2cm]
	\hrule height 1pt
	\vspace{0.5cm}
	\textbf{\Large Simple Road Traffic Modeling}\\[0.5cm]
	\hrule height 1pt
	\vspace{3cm}
	\small{\today{}}}

\author{
	\begin{tabular}{c}
		Gerbaud Florent \\ Fatima Rharrour \\ \\
		9-th october to 20-th December september 2023\\
		\\ Academic tutor : Didier Auroux
	\end{tabular}
}

\date{}
\begin{document}
	\maketitle
	\hspace{2cm}
	\begin{figure}[b]
		\centering
		\begin{minipage}[b]{0.45\linewidth}
			\includegraphics[width=5cm]{logo.png} \\
			%Company tutor : Vincent Vadez
		\end{minipage}
		\hfill
		\begin{minipage}[b]{0.45\linewidth}
			\raggedleft
			\vspace{-0.5cm}
			\includegraphics[width=6cm]{Polytech.png} \\
			%Academic tutor : Cédric Boulbe
		\end{minipage}
	\end{figure}
	\newpage % ajout d'un saut de page
	% Table des matières
	\renewcommand{\contentsname}{
		\hfill
		\begin{tikzpicture}
			\node[draw, fill=white, inner sep=20pt,line width=1.5pt] {\fontsize{30}{36}\selectfont\bfseries Table of Contents};
		\end{tikzpicture}
		\hfill
	}
	\tableofcontents
	\newpage
	\listoffigures % Add a listing of figures
	
	\listofalgorithms
	\newpage
	\section{Presentation of the Subject}
	\subsection{Useful Definition}
	\begin{enumerate}
		\item \textbf{\underline{Ordinary Differential Equation (ODE):}} 
		
		An ODE is a mathematical equation that relates a function to its derivatives with respect to one or more independent variables. ODEs are commonly represented given a function \( F \) of \( x \), \( y \), and derivatives of \( y \). Then, an equation of the form
		\[
		F\left(x,y,y',\ldots ,y^{(n-1)}\right)=y^{(n)}
		\]
		
		\item \textbf{\underline{SMRT}}
		
		SMRT means Simple road traffic simulation.
		
		\item \textbf{\underline{Microscopic simulation}}
		
		Microscopic simulation is a computer-based modeling technique that simulates the behavior of individual entities, such as vehicles or pedestrians, within a system. It focuses on detailed modeling of each entity's movements, interactions, and behaviors to understand and predict the dynamics of a larger system, like traffic flow or crowd movement.
		
		\item \textbf{\underline{FDM}}
		
		The Finite Difference Method (FDM) is a numerical technique used to approximate solutions to differential equations by discretizing the derivatives into finite differences at discrete points within a domain. It transforms continuous equations into a system of algebraic equations, making it computationally feasible to solve problems in various fields such as physics, engineering, and finance.
		Explore the Finite Difference Method—a powerful numerical technique revolutionizing problem-solving in diverse fields. Kumar's concise study delves into its applications, transforming complex differential equations into solvable algebraic systems. \cite{article}
		
		\item \textbf{\underline{Macroscopic simulation}}
		
		Macroscopic simulation models systems at a higher, aggregated level, considering overall behaviors like traffic flow without detailing individual movements. It helps analyze system-level trends and capacities, useful for broader planning.
		
		The relation between microscopic and macroscopic simulation lies in their approach to studying systems. Microscopic simulation focuses on individual entities' detailed behaviors, while macroscopic simulation analyzes aggregated behaviors of the entire system without considering individual entities. They complement each other: microscopic for detailed insights into individual behaviors, and macroscopic for understanding overall system trends and capacities.
		
		\item If you are interested in these types of modelizations, I suggest you go and see this article \cite{dugois:tel-01505473}.
	\end{enumerate}
	
	\subsection{Simple Road Traffic Modeling}
	
		Road traffic modeling involves studying how vehicles behave on road networks, with the aim of simulating and analyzing aspects such as traffic flow, congestion, and driver behavior. This field employs mathematical and computer models to understand and predict traffic patterns, playing a crucial role in urban planning, traffic management, and the development of intelligent transportation systems (as shown in Figure \ref{fig:intro}). 
		
		Explore the integration of a driving simulator with a traffic simulator in Jeihani et al.'s study \cite{JEIHANI2017164}, revealing enhanced traffic density and Variable Message Sign (VMS) reliability. The findings suggest that integration positively influences compliance behavior and factors affecting route diversion.
		
		
		\begin{figure}[H]
			\centering
			\includegraphics[width=0.8\textwidth]{intro.jpg}
			\caption[Road Traffic]{\textbf{\underline{Road Traffic:}} An illustrative example of a road traffic phenomenon, which is the focus of our study.}
			\label{fig:intro}
		\end{figure}
	
		
		\subsubsection{The Objective of SMRT}
		The primary goal of simple road simulation is to analyze and understand vehicle behavior in a controlled and reproducible environment. Researchers and engineers use these simulations to study the impact of various factors on traffic flow, safety, and efficiency. This contributes to the development and testing of traffic management strategies and vehicle control systems, providing insights into the dynamic interactions between vehicles and the road environment.
		
		\subsubsection{Use Case to Explain the Interest of These Simulations}
		Simple road simulations find applications in various fields, including urban planning, transportation engineering, and autonomous vehicle development. For instance, they can assess the effectiveness of new traffic signal timings, study the implications of road design changes, or test the performance of autonomous vehicles in different traffic scenarios. These simulations offer a cost-effective and risk-free way to evaluate real-world interventions and innovations, enhancing decision-making processes and supporting the development of sustainable and efficient transportation systems.
		
		\subsubsection{Field of Application}
		Simple road simulation is applied across a wide range of fields, including transportation research, traffic engineering, and urban planning. It plays a crucial role in the development and validation of autonomous vehicle technologies. The ability to model and simulate various road conditions helps researchers and practitioners make informed decisions, improving the design and management of transportation systems. Simple road simulation serves as a powerful tool for enhancing our understanding of traffic dynamics and contributes to the ongoing evolution of smart and adaptive transportation systems.
		
	
	\subsubsection{Using GitHub for Project Management}
	In this project, we selected GitHub as the primary management tool to facilitate our collaboration, track changes, and manage the source code. The following representation provides an overview of our collaborative use of GitHub as a pair throughout the project.
	\begin{figure}[H]
		\centering
		\includegraphics[width=0.8\textwidth]{GitHub.jpg}
		\caption[Git branching principle]{\textbf{\underline{Git branching principle : }} In this picture, you can see an example of two branches to separate two distinct task }
		\label{fig:GitHub}
	\end{figure}
	
	GitHub's branch feature enabled the two of us to work on different aspects of the project simultaneously without impacting the main codebase. It facilitated the creation of separate environments tailored to specific tasks, allowing for parallel development while maintaining a distinct separation between various project components. This approach significantly improved our collaborative workflow, reducing conflicts and boosting overall productivity.
	
	Furthermore, the issues feature on GitHub played a pivotal role in task management and issue tracking. We utilized this functionality to efficiently create, assign, and monitor tasks. Each issue provided a dedicated space for discussing specific problems, enhancements, or new features, fostering a structured approach to problem-solving and enabling seamless communication between the two of us. This not only helped us maintain a clear overview of pending tasks but also cultivated a collaborative environment where discussions and resolutions were centralized.
	
	\section{Project Objectives}
	
	This project could be decomposed into different parts. The primary objectives of the project were to conduct microscopic and then the macroscopic simulations.
	
	\subsection{Microscopic Simulation}
	
	
	In the case of microscopic simulation, the objective was to simulate traffic flow phenomena using two types of models.
	The first model was a linear approach that considered only the position of the car in front of it. This model, known as the 'Follow-the-Leader' model, simplistically replicates vehicle behavior by focusing solely on its proximity to the preceding car. It assumes that each vehicle adjusts its speed to maintain a safe following distance.
	
	The second model employed was Newell's method, which is more intricate and offers greater realism. Newell's model considers not only the preceding vehicle's position but also incorporates the speed and acceleration of adjacent vehicles. This method captures the interactions between neighboring cars, resulting in a more nuanced representation of traffic dynamics.
	\newline\newline
	
	 In this modeling, we will focus on the position and velocity of multiple vehicles following each other in a single lane. As a first approach we will assume that vehicles accelerate when they have open space, maintain their speed when they are close to the vehicle in front, and brake more strongly as they get very close. We will arrange two and then three vehicles, one behind the other, with the first vehicle maintaining a constant velocity, and observe the behavior of the other vehicles.
	 Once we have completed these simulations, we plan to introduce more complex and realistic conditions and behaviors, such as varying acceleration and encountering obstacles on the road.
	
	\subsection{Macroscopic Simuation}
	
	In the second part of the project, we encountered the limitations of the Microscopic Model. We will delve deeper into these limitations shortly. In essence, it lacks realism and provides fewer details compared to the macroscopic simulation.
	
	To address this issue, we chose to employ Partial Differential Equations (PDEs). In this type of simulation, we do not solely focus on individual car behaviors but rather treat traffic as a fluid-like entity. This approach allows us to gain a better understanding of traffic flow simulation. Considering traffic as a fluid is justified by its collective behavior resembling fluid dynamics—vehicles move in a continuous flow, similar to how fluids move in pipes or channels. Thus, employing PDEs assists in capturing the overall flow dynamics.
	
	Consequently, we utilize a simplified form of the Navier-Stokes equation to tackle the problem.
	
	This enables us to refine our description of the previous simulations by providing a more comprehensive understanding of traffic dynamics within a fluid-like framework. \newline\newline
	
	In clear, the main objectives of the project are: 
	\begin{itemize}
		\item Modelling the behaviour using coupled ordinary differential equations.
		\item Implementing this simplistic modelling.
		\item Modelling the behaviour of traffic flow with PDE
		\item Studying the outcomes based on different parameters.
	\end{itemize}
	
	\subsection{Problems Encountered}
	\subsubsection{Implementation of the Macroscopic model}
		During the phase of developing the Macroscopic models, the difficulties lie in the fact that it was not easy to determine if the graphs we obtained were as expected. To verify their accuracy, we sought feedback from Mr. Auroux and also consulted various websites to compare our results with those of others. Initially, we believed the graphs were correct. However, we later discovered errors in our implementation, which we subsequently rectified.
		
		One of the main problems we encountered was related to the boundary conditions. Initially, for each time step, we used constant boundary conditions. Consequently, the resulting graphs exhibited anomalies at the edges. To address this issue, we conducted research and sought advice from teachers to refine our approach.
		
		Additionally, understanding the models posed a challenge. While the model worked for some cases, it failed for others. This was attributed to the violation of the CFL condition. When the density was too high, the model became unstable. Through an empirical approach, we determined the threshold value and conducted appropriate tests to implement the second model correctly.
	\subsubsection{The time}
		 One of the significant challenges we faced revolved around managing our time effectively. Balancing the demands of our project alongside preparing for exams posed a considerable obstacle. Juggling these concurrent commitments was undeniably demanding. Nonetheless, it presented an invaluable challenge that encouraged us to refine our time management skills and prioritize tasks efficiently. The primary difficulty lay in our inability to delve deeply enough into the subject matter. Due to the time constraints imposed by various commitments, we found it challenging to explore the topic to its fullest extent. Despite this limitation, navigating these time-related obstacles taught us valuable lessons about effective multitasking and the importance of allocating time judiciously to various responsibilities.
	\subsubsection{The perfoming of Equlibrium}
		Achieving equilibrium was relatively straightforward for the Linear Model. However, it proved to be somewhat arduous for Newell's method. Initially, our approach involved attempting to find Analytical Solutions. However, after spending several hours on this calculus and conducting research online, we came to realize that an analytical solution may not exist, and if it does, it could be exceedingly challenging to obtain. This led us to recall the ODE course from previous years, specifically the Lyapunov indirect theorem, which provides criteria to ascertain whether solutions converge or diverge.
	\section{The equation for SMRT}
		\subsection{Differential Ordinary Equation }
		In this part, the idea is to resolve two types of systems of Ordinary Differential Equations (ODEs) that allow us to simulate traffic flow. To achieve this, we will use the Euler Explicit method to numerically solve the solutions.
		The Euler Explicit method is given by the folowing equation :
		\begin{itemize} 
			\item EDO to solve: $\boxed{y'(t) = f{\bigl (}t, y(t){\bigr )}}$.
			\item First step of the resolution: $\boxed{y_0 = y(t_0)}$.
			\item Recursive process to find the n-th solution of the EDO: $\boxed{y_{n+1} = y_{n} + hf(t_{n}, y_{n})}$
		\end{itemize}
		
		
		
		
		
		\subsubsection{Linear Model}
			\textbf{\underline{Mathematical Theory:}}
			\newline
			
			In this section, we're going to explain the math behind our model for understanding how cars behave in traffic. To make things simple, we use a discrete model, which means we look at cars one at a time and how they interact on the road.
			
			Each car's movement is governed by a basic equation:
			
			\begin{align*}
				\boxed{\dot{x_i}(t) = V_i = \alpha_i(x_{i-1} - x_i)}
			\end{align*}
			
			In this equation, \(x_i(t)\) represents where the \(i\)-th car is at a given time, \(V_i\) is how fast the \(i\)-th car is going, and \(\alpha_i\) is a number that describes how that car behaves. The right side of the equation, \(\alpha_i(x_{i-1} - x_i)\), tells us how the car's speed changes based on how close it is to the car in front.
			
			When we put this equation to work for all the cars, we end up with a bunch of equations (one for each car), which helps us understand how they all move together in traffic. These equations give us a dynamic view of how cars influence each other as they drive.
			
			The system of equations is written like this for each car, where \(i\) can be 1, 2, and so on, up to the number of cars:
			
			\begin{align*}
				\left\{
				\begin{array}{ll}
					\dot{x}_1 &= V_1 \\
					\dot{x}_2(t) &= \alpha_2(x_1 - x_2) \\
					&\vdots \\
					\dot{x}_n(t) &= \alpha_n(x_{n-1} - x_n)
				\end{array}
				\right.
			\end{align*}
			
			
			Finally the Sytem associated to the position of each car is : 
			\begin{align*}
				\left\{
				\begin{array}{ll}
					x_1(t + \Delta t) &= x_1(t) + \Delta t  \cdot V_1\\
					x_2(t + \Delta t) &= x_2(t) + \Delta t  \cdot \alpha_2(x_1 - x_2) \\
					&\vdots \\
					x_n(t + \Delta t) &= x_n(t) + \Delta t \cdot  \alpha_n(x_{n-1} - x_n)
				\end{array}
				\right.
			\end{align*}
			These equations help us understand how traffic flows and how individual cars influence one another on the road.
			
			Initially, in the study's initial phase, we treated $\alpha_i$ as a constant. However, as we progressed to the simulation's subsequent phase, we introduced functions $\alpha_i(t)$.
			
			Considering $\alpha_i(t)$ as a constant confines us to a specific model. Yet, our objective is to investigate various behavioral patterns. This motivated us to incorporate three distinct functions capable of altering the values of $\alpha_i(t)$. \newline\newline
			
			1. \textbf{\underline{Constant value:}}
			\[
			\alpha_i(t) = C_i
			\]
			
			2. \textbf{\underline{Sinusoidal with noise:}}
			\[
			\alpha_i(t) = \left| W \cdot \sin(\omega t + \phi) + \mathcal{N}(0, 0.1) \right|
			\]
			
			3. \textbf{\underline{Stochastic Driver Model:}} \newline \newline
			This function generates random noise represented by the variable \( \text{Noise} \). The noise follows a normal distribution, with its mean determined by the parameter \texttt{mean} and its variability controlled by the \texttt{spread} parameter. Mathematically, this can be expressed as:
			
			\[ \text{Noise} = \lvert \mathcal{N}(\text{mean}, \sqrt{\text{spread}}) \rvert \]
			
			Here, \( \mathcal{N}(\text{mean}, \sqrt{\text{spread}}) \) represents a normally distributed random variable with a mean  and a standard deviation \( \sqrt{\text{spread}} \). The absolute value function \( \lvert \cdot \rvert \) ensures that the noise is always positive.
			
			Additionally, if a \texttt{threshold} value is provided, the function constrains the noise within a specific range defined by \( -\text{threshold} \) and \( \text{threshold} \) 
			
			
			The threshold ensures that the noise values do not exceed the range specified by \( -\text{threshold} \) and \( \text{threshold} \). Any noise value falling outside this range is adjusted to the nearest limit defined by the threshold. \newline \newline
			
			\textbf{Mathematically, we can express this as:}
		
			
			\[
			\alpha_i(t) =
			\begin{cases}
				 Noise = \left| \mathcal{N}(\text{average}, \sqrt{\text{spread}}) \right|, & \text{if } -\text{limit} \leq Noise \leq \text{limit}, \\
				\text{limit}, & \text{if } Noise > \text{limit}.
			\end{cases}
			\]
			
			Here, \( \text{average} \) signifies the mean of the acceleration, and \( \text{spread} \) stands for the acceleration's spread. The limit is defined to prevent or create specific situations, like accidents, depending on the desired result. \newpage
			
			
			\textbf{\underline{Implementation : }}
			
			\begin{algorithm}[H]
				\caption{FirstCarSpeed}\label{alg:x1_dot}
				\begin{algorithmic}
					%\State \textbf{Input:} \\
					%\begin{itemize}
						%\State $P_1,P_2,P_3,:=\text{"the 3 first vertex of the 2D mesh"}$
					%\end{itemize}
					\State \textbf{Output:} \\
					\begin{itemize}[]
						\item $\dot{x_1}=V_1$
					\end{itemize}
					\State \textbf{Algorithm:} \\
					\begin{itemize}[]
						\State $\dot{x_1}=130 \times \frac{1000}{3600}$ 
						\State \Return $\dot{x_1}$ 
					\end{itemize}		
				\end{algorithmic}
			\end{algorithm}
			This algorithm allow to return the speed for the first car
			\begin{algorithm}[H]
				\caption{SpeedFOrCarNLinear}\label{alg:xi_dot}
				\begin{algorithmic}
					\State \textbf{Input:} \\
					\begin{itemize}
					\State $t:=\text{"time  step"}$
					\State$x_i:=\text{Table of position for the i-th Car}$
					\State$x_{i-1}:=\text{Table of position for the (i-1)-th Car}$
					\end{itemize}
					\State \textbf{Output:} \\
					\begin{itemize}[]
						\item $\dot{x_i}=V_i$
					\end{itemize}
					\State \textbf{Algorithm:} \\
					\begin{itemize}[]
						\State $\dot{x_i}(t) = V_i = \alpha_i(x_{i-1}[t] - x_i[t])$ 
						\State \Return $\dot{x_i}$ 
					\end{itemize}		
				\end{algorithmic}
			\end{algorithm}
			
			This algorithm allows to return the speed given by the Linear Model for each car of the system
			
			\begin{algorithm}[H]
				\caption{sinusoidal\_model}\label{alg:sinusoidal_model}
				\begin{algorithmic}
					\State \textbf{Input:} \\
					\begin{itemize}
						\State $W := \text{"Amplitude of the perturbation"}$
						\State $\omega := \text{"Angular frequency"}$
						\State $t := \text{"time"}$
						\State $\phi := \text{"Phase (in radians)"}$
					\end{itemize}
					\State \textbf{Output:} \\
					\begin{itemize}
						\item This function returns a value of acceleration $(\alpha_i(t))$ following a sinusoidal model with random noise.
					\end{itemize}
					
					\State \textbf{Algorithm:} \\
					\begin{itemize}
						\State $ \alpha_i(t) = \left| W \cdot \sin(\omega \cdot t + \phi) + N \right|$ 
						\State \text{$N$:="random noise such as N $\sim$ $\mathcal{N}(0,0.01)$"}
						\State \Return $\alpha_i(t)$
					\end{itemize}
				\end{algorithmic}
			\end{algorithm}
			This algorithm allows for variations in acceleration that follow a sinusoidal model to simulate drunk drivers.
			\begin{algorithm}[H]
				\caption{stochastic\_driver\_model}\label{alg:stochastic_driver_model}
				\begin{algorithmic}
					\State \textbf{Input:}
					\begin{itemize}
						\State $\mu := \text{mean of the acceleration}$
						\State $\sqrt{\sigma^2} := \text{acceleration's spread}$
						\State $t := \text{time}$
						\State $\text{threshold} := \text{Threshold value for clipping noise (optional)}$
					\end{itemize}
					\State \textbf{Output:}
					\begin{itemize}
						\State $\text{noise}$: The generated random noise value.
					\end{itemize}
					\State \textbf{Algorithm:}
					\begin{itemize}
						\State Generate a random number $x$ using a normal distribution with $\mu$ and $\sqrt{\sigma^2}$ as parameters.
						\State $\text{noise} \gets |x|$
						\If{$\text{threshold} \neq \text{None}$}
						\If{$\text{noise} < -\text{threshold}$}
						\State $\text{noise} \gets -\text{threshold}$
						\EndIf
						\If{$\text{noise} > \text{threshold}$}
						\State $\text{noise} \gets \text{threshold}$
						\EndIf
						\EndIf
						\State \textbf{return} $\text{noise}$
					\end{itemize}
				\end{algorithmic}
			\end{algorithm}
			This algorithm allows for variations in acceleration that follow a Stochastic model to simulate unpredictable drivers.
			
			
			
			\begin{algorithm}[H]
				\caption{UpdatePositionsAndVelocities}\label{alg:update_positions}
				\begin{algorithmic}
					\State \textbf{Input:} \\
					\begin{itemize}
						\State $t:=\text{time step}$
						\State $x_1Pos:=\text{Table of position for the 1st Car}$
						\State $x_2Pos:=\text{Table of position for the 2nd Car}$
						\State $v_1:=\text{Table of velocity for the 1st Car}$
						\State $v_2:=\text{Table of velocity for the 2nd Car}$
						\State $time:=\text{Table of time values}$
						\State $h:=\text{time step size}$
					\end{itemize}
					\State \textbf{Output:} \\
					\begin{itemize}
						\item $x_1Pos$ 
						\item $x_2Pos$
					\end{itemize}
					\begin{itemize}[]
						\item $accident:=\text{Flag indicating whether an accident occurred}$
					\end{itemize}
					\State \textbf{Algorithm:} \\
					\begin{itemize}[]
						\For{$t$ in range(1, $n\_steps$)}
						\State $x_1Pos[t] = x_1Pos[t-1] + \dot{x_1}() \times h$
						\State $x_2Pos[t] = x_2Pos[t-1] + \dot{x_2}(t-1) \times h$
						
						\State $v_1[t] = \dot{x_1}()$
						\State $v_2[t] = \dot{x_2}(t)$
						
						\State $time[t] = time[t-1] + h$
						
						\If{isAccident($t$)}
						\State $accident = \text{True}$
						\State \textbf{break}
						\EndIf
						\EndFor
					\end{itemize}
					\State \textbf{Return} $x_1Pos$, $x_2Pos$
				\end{algorithmic}
			\end{algorithm}
			This algorithm enables the implementation of the Euler Explicit Method on the Linear Model.
			
		\newpage
		\subsubsection{Newell's Model} 
		\textbf{\underline{Mathematical Theory:}}
		In this section, we model the velocity using an exponential model, so the movement of each car is given by:
		\begin{align*}
			\boxed{\dot{x_i}(t) =V_i(1-e^{-\frac{\lambda_i}{V_i}(x_{i-1}(t) - x_i(t) - d_i})}
		\end{align*} 
		$V_i$, $\lambda_i$, $d_i$ parameters associated with the ith car:
		\begin{itemize}
			\item $V_i$ : the maximum velocity of the ith car.
			\item $\lambda_i$ : the capacity of acceleration/decelaration.
			\item $d_i$ : the minimum headway(safe following distance). 
		\end{itemize}
		By using this equation for each car, we get a bunch of equations—one for each car. This helps us grasp how they all move together in traffic. These equations give us a dynamic picture of how cars affect each other as they drive.\newline
		
		The set of equations is written like this for each car, where $i$ can be 1, 2, and so on, up to the total number of cars:
		\begin{align*}
			\left\{
			\begin{array}{ll}
				\dot{x}_1 &= V_1 \\
				\dot{x}_2(t) &= V_2(1-e^{-\frac{\lambda_2}{V_2}(x_{1}(t) - x_2(t) - d_2}) \\
				&\vdots \\
				\dot{x}_n(t) &= V_n(1-e^{-\frac{\lambda_n}{V_n}(x_{n-1}(t) - x_n(t) - d_n})
			\end{array}
			\right.
		\end{align*}
		\newline
		And so, the position of each vehicle is:
		\begin{align*}
			\left\{
			\begin{array}{ll}
				x_1(t + \Delta t) &= x_1(t) + \Delta t \cdot  V_1\\
				x_2(t + \Delta t) &= x_2(t) + \Delta t \cdot V_2(1-e^{-\frac{\lambda_2}{V_2}(x_{1}(t) - x_2(t) - d_2}) \\
				&\vdots \\
				x_n(t + \Delta t) &= x_n(t) + \Delta t \cdot V_n(1-e^{-\frac{\lambda_n}{V_n}(x_{n-1}(t) - x_n(t) - d_n})
			\end{array}
			\right.
		\end{align*}
		\newpage
		\textbf{\underline{Implementation:}} \newline\newline
		
		for $\dot{x_1}$, we use the same algorithm than for the Linear model., However, to calculate the $\dot{x_i}$ values we use the following algorithm.
		
		\begin{algorithm}[H]
			\caption{SpeedFOrCarNNewell}\label{alg:xi_dot}
			\begin{algorithmic}
				\State \textbf{Input:} \\
				\begin{itemize}
					\State $t:=\text{"time  step"}$
					\State$x_i:=\text{Table of position for the (i)th Car}$
					\State$x_{i-1}:=\text{Table of position for the (i-1)th Car}$
					\State$d_{i}:=\text{Safe following distance the (i)th Car}$
				\end{itemize}
				\State \textbf{Output:} \\
				\begin{itemize}[]
					\item $\dot{x_i}:=V_i$
				\end{itemize}
				\State \textbf{Algorithm:} \\
				\begin{itemize}[]
					\State $\dot{x_i}(t):=V_i(1-e^{-\frac{\lambda_i}{V_i}(x_{i-1}(t) - x_i(t) - d_i})$ 
					\State \Return $\dot{x_i}$ 
				\end{itemize}		
			\end{algorithmic}
		\end{algorithm}
		This algorithm determines the derivative of $x_i$ with respect to time, $\dot{x_i}$, based on the positions of the $i$th and $(i-1)$th cars, the safe following distance $d_i$, and the time step $t$. The result represents the velocity $V_i$ of the $i$th car. \newline\newline
		
		For other implementations such as the Euler Explicit method or variations of acceleration, the algorithm remains exactly the same as used in the previous section.
		\newpage
		\subsection{Partial Differential Equations}
		
		\subsubsection{Euler Explicit}
		
		\textbf{\underline{Mathematical Theory:}} \newline\newline
		
			In the second part, the aim was to simulate the phenomenon of car traffic as a fluid. This means that instead of studying each car independently of the others, we concentrate on analyzing the density of cars. To carry out this study, we need to use a partial differential equation (PDE) model.
		
		The PDE model used is the LWR (Lighthill-Whitham-Richards) equation. This equation can be used to simulate vehicle traffic, taking into account parameters of varying complexity. To find out more on this subject, discover how the uncertainty of the fundamental diagram of the LWR traffic model affects prediction reliability, by showing the increase in location uncertainty over time while accurately predicting the magnitude of the disturbance. \cite{article}. The equation is defined exactly as follows:
		
		\begin{align*}\label{eq:PDE}
			\boxed{
				\begin{aligned}
					&\partial_t\rho + \partial_xF(\rho)=0, && x\in \Omega, t\ge 0,\\
					&\rho(x,0)=\rho_0(x), && x \in \Omega, \\
					&\rho(0,t)=\rho(L,t), && t\ge 0
			\end{aligned}}
		\end{align*}
		
		\textbf{Where:}
		\begin{align*}
			& \Omega := \left] 0,L\right[, \\
			& \rho(x,t) \text{ represents the traffic density at position } x \text{ and time } t, \\
			& F(\rho) \text{ denotes the traffic flux as a function of density,} \\
			& F(\rho) \text{ is often represented by a function modeling the relationship between traffic density and traffic velocity,} \\
			& F(\rho) = V(\rho) \cdot \rho, \text{ where } V(\rho) \text{ is the traffic velocity as a function of density}.
		\end{align*}
		\newline
		
		For the study, we choose to take the following model : 
		\begin{align}
			\boxed{\partial_t\rho + \partial_x\left[ \rho\left( 1-\frac{\rho}{\rho_{\text{max}}}\right) \cdot V_{\text{max}}\right] = 0 }
		\end{align}
	
		
		The first step to doing some simulation was to define a numerical model to calculate the appoximation of the solution.
		We choose the mzthod the most usual. Euler excplit method.
		So for the Free Flow model, the shem is given by : 
		\begin{align*}
			\boxed{\rho_{i}^{n+1} = \rho_i^n - \frac{\Delta t}{\Delta x} \cdot \left(\rho_i^n \cdot v_i^n - \rho_{i-1}^n \cdot v_{i-1}^n \right)
				=0}
		\end{align*}
		\textbf{\underline{Where : }}
		\begin{align*}
			\boxed{v_i^n = \left( 1 - \frac{\rho_i^n}{\rho_{max}}\right)  \times V_{max}}
		\end{align*}
		\newpage
		The approach for calculating density involves creating a matrix where each row represents a time step and each column represents a spatial point. Initially, this matrix is populated with zeros, except for the first row, which holds the initial conditions.
		
		This matrix structure appears as follows:
		
		\begin{align*}
			\bordermatrix { 
				& \Delta_x & 2\cdot \Delta_x & \hdots & L \cr 
				\Delta_t & \rho_1^1 & \rho_2^1 & \hdots & \rho_L^1 \cr \cr
				2\cdot \Delta_t & \rho_1^2 & \rho_2^2 & \hdots & \rho_L^2\cr
				\vdots & \vdots & \vdots & \hdots & \vdots \cr
				T & \rho_1^T & \rho_2^T & \hdots & \rho_L^T}
		\end{align*}
		

		Initially, the matrix is filled with zeros except for the first row, which contains the initial density conditions:

		\begin{align*}
			\bordermatrix { 
				& \Delta_x & 2\cdot \Delta_x & \hdots & L \cr 
				\Delta_t & \rho_0(\Delta_x) & \rho_0(2 \cdot \Delta_x) & \hdots & \rho_0(L) \cr 
				2\cdot \Delta_t & \rho(0,2\cdot \Delta_t)=\rho_0(L) & 0 & \hdots & 0\cr
				\vdots & \vdots & 0 & \hdots & 0 \cr
				T & \vdots & 0 & \hdots & 0}
		\end{align*}

		 
	
		Subsequent values in the matrix are calculated based on the previous values using the formula:
		
		\[
		\rho_{i}^{n+1} = \rho_i^n - \frac{\Delta t}{\Delta x} \cdot \left(\rho_i^n \cdot v_i^n - \rho_{i-1}^n \cdot v_{i-1}^n \right) = 0
		\]
		
		It's important to understand that for each spatial step where x=0 at time step i, the condition is initialized with the last value realized at time i-1.
		
		The matrix shows an example. For time step $2\cdot \Delta_t$, the first value is initialized with the last value of time $\Delta_t$. Once we have these initial values, we calculate the other values for the current time step using the previous formula.


		\subsection{Lax-Friedrich Model}
		
		The problem with the previous scheme is that for a density higher than 0.5, the solution becomes unstable and diverges towards infinity. To solve this problem, we decided to implement the Lax-Friedrich model. The theoretical model for the Lax-Friedrich method in the non-linear system is as follows:
		
		\begin{align}
			\boxed{u_{i}^{n+1} = \frac{1}{2}(u_{i+1}^{n} + u_{i-1}^{n}) - \frac{\Delta t}{2\Delta x}(f(u_{i+1}^{n}) - f(u_{i-1}^{n}))}
		\end{align}
		
		In the case of our equation the sheme to solve is the follwoing one : 
		\begin{equation}
			\boxed{
				\rho_{j}^t = \frac{1}{2} \left(\rho_{j+1}^{t-1} + \rho_{j-1}^{t-1}\right) - \frac{\Delta t}{2 \cdot \Delta x} \left( \rho_{j+1}^{t-1} \left(1 - \frac{\rho_{j+1}^{t-1}}{R}\right) \cdot V_{\text{max}} - \rho_{j-1}^{t-1} \left(1 - \frac{\rho_{j-1}^{t-1}}{R}\right) \cdot V_{\text{max}} \right)
			}
		\end{equation} \newpage
	
		
		\textbf{\underline{Implementation:}} \newline\newline
		
		\begin{algorithm}[H]
			\caption{EulerExplicitTrafficFlow}\label{alg:euler_traffic_flow}
			\begin{algorithmic}
				\State \textbf{Input:}
				\State $u_{0_x}$: Initial condition function for $x$
				\State $\Delta_x$: Spatial step size
				\State $\Delta_t$: Time step size
				\State $T$: Total time of Simulation
				\State $L$: TOtal space for the Simulation
				\State $V_{\text{max}}$: Maximum velocity
				\State $R$: Maximal density of the simulation
				\State \textbf{Output:}
				\State $\rho$: Matrix storing the density for each time step and time space 
				\State \textbf{Algorithm:}
				\State $\text{maxT} \gets \lfloor  \frac{T}{\Delta_t} \rfloor  + 1$ \newline
				\State $\text{maxL} \gets \lfloor  \frac{T}{\Delta_x} \rfloor  + 1$ \newline
				\State $U \gets \text{Matrix of size}(\text{maxT}, \text{maxL})$
				\State $U[0, :] \gets \left[ \text{compute } u_{0_x}(x) \text{ for } x \text{ in } \text{range}(0, L) \right]$
				\For{$t$ \textbf{in} $\text{range}(1, \text{maxT})$}
				\For{$j$ \textbf{in} $\text{range}(0, \text{maxL})$}
				\If{$\text{typeSimu} == "EE"$}
				\State $\rho_i^n \gets U[t-1, j]$
				\State $\rho_{i-1}^n \gets U[t-1, j-1]$
				\State $v_i^n \gets \left( 1 - \frac{\rho_i^n}{R}\right)  \times V_{max}$ \newline
				\State $v_{i-1}^n \gets \left( 1 - \frac{\rho_{i-1}^n}{R}\right)  \times V_{max}$
				\State $\rho_{j}^t \gets \rho_i^n - \frac{\Delta t}{\Delta x} \cdot \left(\rho_i^n \cdot v_i^n - \rho_{i-1}^n \cdot v_{i-1}^n\right)$
				\ElsIf{$\text{typeSimu} == "LF"$}
				\If{$j+1<\text{maxL}$}
				\State $\boxed{\rho_{j}^t = \frac{1}{2} \left(\rho_{j+1}^{t-1} + \rho_{j-1}^{t-1}\right) - \frac{\Delta t}{2 \cdot \Delta x} \left( \rho_{j+1}^{t-1} \left(1 - \frac{\rho_{j+1}^{t-1}}{R}\right) \cdot V_{\text{max}} - \rho_{j-1}^{t-1} \left(1 - \frac{\rho_{j-1}^{t-1}}{R}\right) \cdot V_{\text{max}} \right)}$
				\Else
				\State $\boxed{\rho_{j}^t = \frac{1}{2} \left(\rho_{0}^{t-1} + \rho_{j-1}^{t-1}\right) - \frac{\Delta t}{2 \cdot \Delta x} \left( \rho_{0}^{t-1} \left(1 - \frac{\rho_{0}^{t-1}}{R}\right) \cdot V_{\text{max}} - \rho_{j-1}^{t-1} \left(1 - \frac{\rho_{j-1}^{t-1}}{R}\right) \cdot V_{\text{max}} \right)}$
				\EndIf
				\EndIf
				\EndFor
				\EndFor
				\State \textbf{return} $U$
			\end{algorithmic}
		\end{algorithm}

		
	
	
	
	
	\section{Types of Simulations Performed with ODE models}
	
	For the simulation, we ran two-car and three-car tests to demonstrate different results. In this section, we will first study the simulation involving two cars to illustrate the "accordion phenomenon", where acceleration remains constant throughout the simulations. Next, we'll analyze the position variations of three cars, focusing in particular on the evolution of acceleration over time. Interestingly, the observed phenomenon remains constant in both types of simulation. However, simulations involving three cars are more interesting. For simulations involving two cars, please refer to the "Stability study" section or to the appendix.
	
	\subsection{Simulation with Drivers Reacting Similarly}
		\subsubsection{Accordion Phenomenon}
		
		For this parts, we make the following assumptions:
		
		\begin{itemize}
			\item The first car maintains a constant speed over time.
			\item The second car reaction is based on the behavior of the first one.
			\item The acceleration of the second car is governed by a constant function, denoted as alpha, which remains fixed. In the algorithm \ref{alg:xi_dot} we took $\alpha_2=2.0$
		\end{itemize} 
		
		The initial simulation we wanted to carry out was intended to demonstrate and illustrate driver behavior in real-life scenarios. Figure \ref{fig:Aco1} faithfully represents this phenomenon. Specifically, we observe that if the second car is too far from the first, it decelerates. Conversely, when it is far enough away from the first car, it increases its speed.
		
		\begin{figure}[H]
			\centering
			\includegraphics[width=0.8\textwidth]{Accordeon1.png}
			\caption[Simulation of accordion phenomenon with Linear Model]{\textbf{\underline{Simulation of accordion phenomenon with Linear Model : }} In this image, you can see how the positions of two cars change over time. The blue car maintains a steady speed, while the orange car trails behind the blue car. The graph representing the orange car's movement appears to fluctuate periodically, resembling an accordion expanding and contracting over time.}
			\label{fig:Aco1}
		\end{figure}
		
		\newpage
		Just like in the Linear Model, using Newell's method produces the same type of outcomes. As shown in Figure \ref{fig:1W2_ACCORD}, the graph demonstrates the accordion effect, displaying cycles of acceleration succeeded by deceleration.
		
		\begin{figure}[H]
			\centering
			\includegraphics[width=0.8\textwidth]{1W2_Accord.png}
			\caption[Simulation of accordion phenomenon with Newell's Model]{\textbf{\underline{Simulation of accordion phenomenon with Newell's Model : }} In this image, you can see how the positions of two cars change over time. The blue car maintains a steady speed, while the orange car trails behind the blue car. The graph representing the orange car's movement appears to fluctuate periodically, resembling an accordion expanding and contracting over time.}
			\label{fig:1W2_ACCORD}
		\end{figure}
		
		What we can conclude from these two graphs is that, in the linear model, the acceleration and deceleration are slightly less realistic compared to Newell's method. Specifically, in the linear model, we observe that when the car is too close to another, it almost doesn't move and remains near 0 km/h, then it accelerates very rapidly. Conversely, with Newell's model, we notice that the acceleration and deceleration are more realistic as they follow a more progressive pattern.
		
		\subsection{Simulation with Drunk Drivers}
		
		In this type of simulation, we aimed to make the model more realistic by incorporating variations in the acceleration of the car.
		
		Specifically, in this section, we consider a scenario where one of the drivers is intoxicated. Consequently, the driver's acceleration fluctuates over time. The Hypotesis are the following one 
		\begin{itemize}
			\item The first car is traveling at a constant speed but is subject to some obstacles on the road at times.
			\item The second car (orange) is erratic as it is driven by a drunk driver, causing completely random variations in its position.
			\item The last one (blue) accelerates when it has distance and decelerates when it is too close.
		\end{itemize}
		The graph illustrates a noticeable departure from the periodic accordion phenomenon observed earlier. Instead, it becomes non-periodic and entirely unpredictable. In Figure \ref{fig:Model1W3C_O_Aco_D2_Linear}, we observe that compared to the standard model (without acceleration variations), the behavior of the car becomes entirely unpredictable and may lead to accidents. For instance, around time 20, the orange car nearly collided with the blue car. Since this model employs sinusoidal functions to simulate the erratic behavior of an intoxicated driver, instances of accidents can occasionally appear on the graph. Thus, this simulation becomes more interesting as it represents a real-life scenario. However, it is interesting to remark that compared to Newell's method (Figure \ref{fig:Model1W3C_O_Aco_D2_Newell}), the variations are very significant, potentially resulting in a lack of precision. In fact, in the Newell's model, the simulation is more realistic due to the smoothing of variations and much less abrupt changes in positions.
		
		\begin{figure}[H]
			\centering
			\includegraphics[width=\textwidth]{Model1W3C_O_Aco_D2_Linear.png}
			\caption[Simulation of Traffic Flow with one drunk driver (Linear Model).]{\textbf{\underline{Simulation of Traffic Flow with one drunk driver (Linear Model) : }} In this picture, you can observe the positional changes of three cars. The first one (blue) maintains a constant speed but occasionally faces obstacles on the road. The second one (orange) follows behind the first car with a driver who is intoxicated. The last car slows down when it gets too close to the orange car and accelerates if it has enough space ahead.}
			\label{fig:Model1W3C_O_Aco_D2_Linear}
		\end{figure}
		
		\begin{figure}[H]
		\centering
		\includegraphics[width=\textwidth]{Model1W3C_O_Aco_D2_Newell.png}
		\caption[Simulation of Traffic Flow with one drunk driver (Newell's Model).]{\textbf{\underline{Simulation of Traffic Flow with one drunk driver (Newell's Model) : }} In this picture, you can observe the positional changes of three cars. The first one (blue) maintains a constant speed but occasionally faces obstacles on the road. The second one (orange) follows behind the first car with a driver who is intoxicated. The last car slows down when it gets too close to the orange car and accelerates if it has enough space ahead. You could observe that the variations of position is more constant than in the linear model.}
		\label{fig:Model1W3C_O_Aco_D2_Newell}
	\end{figure}
		
		\subsection{Simulation with Unpredictable Drivers}
		
			In this simulation incorporating another type of variations in the acceleration of the car. Specifically, in this section, we consider a scenario where one of the drivers is unpredictable. Consequently, the driver's acceleration fluctuates over time. The Hypotesis are the following one 
			\begin{itemize}
				\item The first car is traveling at a constant speed but is subject to some obstacles on the road at times.
				\item The second car (orange) is a dangerous driver du to unpredictable comportment.
				\item The last one (blue) accelerates when it has distance and decelerates when it is too close.
			\end{itemize}
			
			In these figures, we observe a new phenomenon. Firstly, it is noticeable in Figure \ref{fig:Model1W3C_O_Aco_D2_Linear} that the drivers exhibit very risky behavior, as sometimes they move very slowly and other times they accelerate significantly. Even though this model is similar to the Drunk Drivers model, it remains interesting because it better demonstrates the effect of the Newell method. Specifically, as shown in Figure \ref{fig:Model1W3C_O_Aco_I2_Newell}, the graph appears smoother because the accelerations are more realistic, being linear. We also notice that the phases of unpredictability are more numerous than in the linear model. However, the drivers exhibit only two types of behavior (it moving or it stop is car). This can be interpreted in two ways. The first interpretation is that it increases the danger posed by the drivers because they repeatedly stop and then accelerate, which can be hazardous for preceding vehicles. Another interpretation could be the limitation of the Newell model in this specific case. In reality, for a more accurate model, it lacks a phase where the car moves but at a slow pace. This aspect is intriguing. A better model could combine these two phenomena: more unpredictable phases (With linear acceleration or polynomial acceleration, but controlled to achieve a more realistic outcome.), as shown in Figure \ref{fig:Model1W3C_O_Aco_I2_Newell}, with the presence of phases where the driver moves very slowly.
		
			\begin{figure}[H]
			\centering
			\includegraphics[width=\textwidth]{Model1W3C_O_Aco_I2_Linear.png}
			\caption[Simulation of Traffic Flow with one drunk driver (Newell's Model).]{\textbf{\underline{Simulation of Traffic Flow with one drunk driver (Newell's Model) : }} In this picture, you can observe the positional changes of three cars. The first one (blue) maintains a constant speed but occasionally faces obstacles on the road. The second one (orange) follows behind the first car with a driver who is intoxicated. The last car slows down when it gets too close to the orange car and accelerates if it has enough space ahead. You could observe thath the variations of position is more constant than in the linear model.}
			\label{fig:Model1W3C_O_Aco_I2_Linear}
		\end{figure}
		
			\begin{figure}[H]
			\centering
			\includegraphics[width=\textwidth]{Model1W3C_O_Aco_I2_Newell.png}
			\caption[Simulation of Traffic Flow with one drunk driver (Newell's Model).]{\textbf{\underline{Simulation of Traffic Flow with one drunk driver (Newell's Model) : }} In this picture, you can observe the positional changes of three cars. The first one (blue) maintains a constant speed but occasionally faces obstacles on the road. The second one (orange) follows behind the first car with a driver who is intoxicated. The last car slows down when it gets too close to the orange car and accelerates if it has enough space ahead. You could observe thath the variations of position is more constant than in the linear model.}
			\label{fig:Model1W3C_O_Aco_I2_Newell}
		\end{figure}
	
		
		
		\subsubsection{Accident Phenomenon For The Linear Model }
		
		In this scenario, the objective is to demonstrate that if a driver has a longer reaction time, an accident may occur. In this particular case, we retained the same assumptions as before, except with a slightly lower acceleration capacity and a longer reaction time. In algorithm \ref{alg:xi_dot}, we used $\alpha_2=1.75$, and in algorithm \ref{alg:update_positions}, we used $h=1.5$. As depicted in figure \ref{fig:Acc1}, the accident is confirmed due to a curve intersection (the position of the second car (orange) surpasses that of the first car (blue)). This indicates that the second car collided with the first car. In this scenario, the aim is only to illustrate that an accident only becomes apparent when the distance to the preceding car is greater than that to the first car. However, in any simulation, the accident can be observed in the same way, so we are no longer particularly interested in this type of simulation For further graphical studies.
		
		If you wish to see other graph i invite you to see the figure in annexe or to go on the GitHub project.
	
		
		\begin{figure}[H]
			\centering
			\includegraphics[width=0.8\textwidth]{Acc1.png}
			\caption[Simulation of Accident case between two cars]{\textbf{\underline{Simulation of Accident case between two cars : }} In this picture, you can observe the position evolutions of two cars, the first one (blue) maintaining a constant speed, and the second one (orange) following behind the first one. We could see on The graph shows that the acceleration of the orange car is too large. This implies an accident between two cars.}
			\label{fig:Acc1}
		\end{figure}
		
		\subsection{Study of Equilibrium, Stability, and Instability of the Solution}
		\subsubsection{System Stability and Equilibrium for the Linear Model}
		In this section, the goal is to investigate the difference in distance between two cars to determine the stability of solutions and ascertain whether an equilibrium exists. To achieve this, we analyze the solutions of the following system of equations:
		\begin{align*}
			\begin{cases}
				\dot{d_1} &= V_1 - \alpha_2 \cdot d_1 \\
				&\vdots \\
				\dot{d_n} &= \alpha_n \cdot d_{n-1} - \alpha_{n+1} \cdot d_n
			\end{cases}
		\end{align*}
		
		In our context, two cars constitute a 1D system, whereas with 3 cars, we encounter a 2D system of equations. Now, let's delve into the system's stability and equilibrium: \newline
		
		\textbf{\underline{With 2 Cars}}:
		
		The equation of interest for analysis is:
		\begin{align*}
			\dot{d_1} &= V_1 - \alpha_2 \cdot d_1
		\end{align*}
		
		Upon solving (\ref{eq:EDO1}), we obtain the following equation for \(d_1(t)\):
		\begin{align*}
			\boxed{d_1(t) = \frac{{V_1 - V_1 \cdot e^{-\alpha_2(t-t_0)} + \alpha_2 \cdot d_1(t_0) \cdot e^{-\alpha_2(t-t_0)}}}{\alpha_2}}
		\end{align*}
		
		Initially, the assumption was that if $\alpha_2 < 0$, the solution would diverge, with one car moving backwards and the other forwards. Analyzing the equation, we see that the terms $V_1$ and $\alpha_2 \cdot d_1(t_0)$ remain constant and have less influence.
		
		Nevertheless, both terms, $e^{-\alpha_2(t-t_0)}$, represent exponential functions of time. When $\alpha_2$ is negative, these exponentials grow exponentially with time.
		
		Consequently, the equation remains stable and converges to equilibrium $\boxed{d_1(t)=\frac{V_1}{\alpha_2}}$ if $\alpha_2 > 0$.
		
		These results are shown graphically in figures \ref{fig:RC1} and \ref{fig:RS1}. It's important to note that in all figures, there is no explosion of the solution. In particular, in figure \ref{fig:RC1}, the car's position exhibits periodic behavior as a function of time. Furthermore, in figure \ref{fig:RS1}, the illustration shows the convergence of the distance between the two cars towards an equilibrium state.
		
			
		
		\begin{figure}[H]
			\centering
			\includegraphics[width=0.8\linewidth]{RealisticCase.png}
			\caption[Realistic Case for the Linear Model with Two Cars]{\textbf{\underline{Realistic Case for the Linear Model with Two Cars: }}This simulation illustrates real-life behavior, characterized by a reaction time of approximately 1 second, achieved using a time step of 1 second instead of smaller increments in the algorithm. The solution is obtained with the Euler-Explicit method}
			\label{fig:RC1}
		\end{figure}
		
		\begin{figure}[H]
			\centering
			\includegraphics[width=0.8\linewidth]{RealSolCase.png}
			\caption[Real Solution for the Linear Model with Two Cars]{\textbf{\underline{Real Solution for the Linear Model with Two Cars: }}This simulation depicts the accurate solution of the ODE (Ordinary Differential Equation), portraying an infinitesimally small reaction time through the use of smaller time increments in the algorithm, rather than representing real-life scenarios. The solution is obtained with the Euler-Explicit method}
			\label{fig:RS1}
		\end{figure}
		
		The subsequent part of our study aims to emphasize the impact of \(\alpha_2\) values on the stability of the system. For \(\alpha_2 > 0\), the distance between two cars converges, while for \(\alpha_2 < 0\), the ODE becomes unstable.
		
		To visualize this, Figure \ref{fig:AS1} showcases different analytical solutions of the ODE with \(\alpha_2\) values greater than 0. Conversely, Figure \ref{fig:AS2} displays analytical solutions for \(\alpha_2\) values lower than 0. These plots align with theoretical predictions, demonstrating stable solutions in Figure \ref{fig:AS1}, which converge to equilibrium, while unstable solutions are evident in Figure \ref{fig:AS2}.
		
		\begin{figure}[H]
			\centering
			\includegraphics[width=0.8\linewidth]{Stability.png}
			\caption[Analytical Solutions for the Linear Model with Two Cars]{\textbf{\underline{Analytical Solutions for the Linear Model with Two Cars (Stability): }}Different plots displaying the Analytical Solutions for various acceleration values.}
			\label{fig:AS1}
		\end{figure}
		
		\begin{figure}[H]
			\centering
			\includegraphics[width=0.8\linewidth]{Unstability.png}
			\caption[Analytical Solutions for the Linear Model with Two Cars]{\textbf{\underline{Analytical Solutions for the Linear Model with Two Cars (Instability): }}Different plots displaying the Analytical Solutions for various acceleration values.}
			\label{fig:AS2}
		\end{figure}
		
		Finally, the last step was to show how the solution behaves. On Figure \ref{fig:FV1}, for a given acceleration greater than 0, the field of vectors converges onto the equilibrium. However, for negative acceleration, the field of vectors on Figure \ref{fig:FV2} diverges from the equilibrium.
		
		\begin{figure}[H]
			\centering
			\includegraphics[width=0.7\textwidth]{FieldOfVector_CV.png}
			\caption[Field Of Vector for the Linear Model (Stability)]{\textbf{\underline{Field Of Vector for the Linear Model (Stability): }} On this figure, you could see the field of vectors that converges to the equilibrium.}
			\label{fig:FV1}
		\end{figure}
		
		\begin{figure}[H]
			\centering
			\includegraphics[width=0.7\textwidth]{FieldOfVector_DV.png}
			\caption[Field Of Vector for the Linear Model (Instability)]{\textbf{\underline{Field Of Vector for the Linear Model (Instability): }} On this figure, you could see the field of vectors that diverges from the equilibrium.}
			\label{fig:FV2}
		\end{figure}
		
		\textbf{\underline{With 3 cars}} : \newline\newline
		
		After the resolution (\ref{eq:EDO2}) we obtain the next equation for $d_1(t)$ and $d_2(t)$ : 
		
		\begin{align*}
			\begin{cases}
				d_1(t) &= \frac{C_1(\alpha_3-\alpha_2)}{\alpha_2e^{\alpha_2t}}+ \frac{V_1}{\alpha_2}\\
				d_2(t) &= \frac{C_1}{e^{\alpha_2t}} + \frac{C_2}{e^{\alpha_3 \cdot t}} + \frac{V_1}{\alpha_3}
			\end{cases}
		\end{align*}
		
		we set the initial condition to $d_1(0)=m, d_2(0)=n$ So we find easily $C_1$ and $C_2$ : 
		\begin{align*}
			&C_1=\frac{m\alpha_2-V_1}{\alpha_3-\alpha_2} \\
			&C_2=n-\frac{V_1}{\alpha_3} - C_1
		\end{align*}
		
		In a scenario involving just three cars, examination of the formula's components leads us to a crucial observation: a divergence situation occurs when the value of $\alpha_2$ or $\alpha_3$ is less than zero. This result is in line with our initial expectations.
		
		As the equations governing the system remain consistent in the case of "n" cars, with the exception of the constant $\alpha_i$, this equilibrium analysis can be applied to any number of cars ("n").
		
		The visual representation in Figure \ref{fig:SE1} elucidates the equilibrium dynamics. In the left subfigure, the vector field demonstrates convergence towards the equilibrium point. Simultaneously, the right subfigure presents the Analytical Solutions derived from the system of Ordinary Differential Equations (ODEs).
		
		\begin{figure}[H]
			\centering
			\begin{subfigure}{0.45\textwidth}
				\centering
				\includegraphics[width=\linewidth]{FieldOfVector_CV2.png}
			\end{subfigure}
			\hfill
			\begin{subfigure}{0.45\textwidth}
				\centering
				\includegraphics[width=\linewidth]{AnalyticalSolution.png}
			\end{subfigure}
			\caption[Visualisation of the equilibrium]{\textbf{\underline{Visualisation of the equilibrium:}} On the left figure, you could see the vector field that converges onto the equilibrium point. On the right, the Analytical Solutions of the system of ODEs.}
			\label{fig:SE1}
		\end{figure}
		
		Examining Figure \ref{fig:SE1}, it's evident that for positive acceleration, the vector field directs towards equilibrium. The distances between car 1 and 2, as well as between car 2 and 3, converge toward the equilibrium as indicated by the vector field.
		
		Contrarily, in Figure \ref{fig:SE2}, representing a scenario with negative acceleration, similar to the case of two cars, divergence is observed. Consequently, this divergence implies the absence of a feasible solution.
		
		\begin{figure}[H]
			\centering
			\begin{subfigure}{0.45\textwidth}
				\centering
				\includegraphics[width=\linewidth]{FieldOfVector_DV2.png}
			\end{subfigure}
			\hfill
			\begin{subfigure}{0.45\textwidth}
				\centering
				\includegraphics[width=\linewidth]{AnalyticalSolution2.png}
			\end{subfigure}
			\caption[Visualisation of the Divergence]{\textbf{\underline{Visualisation of the Divergence:}} On the left figure, you could see the vector field that diverges from the theoretical equilibrium. On the right, the Analytical Solutions of the system of ODEs that completely diverge to infinity.}
			\label{fig:SE2}
		\end{figure}
		
		Figure \ref{fig:SE2} provides a visual illustration of this divergence phenomenon. The left-hand sub-figure illustrates the divergence of the vector field from the theoretical equilibrium point. At the same time, the right-hand sub-figure shows the analytical solutions derived from the set of EDOs, demonstrating complete divergence leading to infinity. This divergence pattern is consistent with the negative acceleration scenario, echoing the absence of feasible solutions.
		
		
	\subsubsection{System Stability and Equilibrium for the Newell's Model}
	
	\textbf{\underline{The Study of the equilibrium for two cars : }} \newline\newline
	
	
	The objective here, as before, is to study the stability of the model. The 1D equation is as follows:
	
	\begin{align*}
		&\dot{d_1}(t) = \dot{x_1}(t) - \dot{x_2}(t) = V_1 - V_2 + V_2 \cdot e^{-\frac{\alpha_2}{V_2}(d_1 - d_{2}^{sec})} = f(d_1, t), \\
		&\left\{
		\begin{aligned}
			V_1 &:= \text{Maximum speed for car number 1}, \\
			V_2 &:= \text{Maximum speed for car number 2}, \\
			\alpha_2 &:= \text{capacity of acceleration for car number 2}, \\
			d_{2}^{sec} &:= \text{security distance that car number 2 maintains}.
		\end{aligned}
		\right.
	\end{align*} \\ Firstly, after performing this calculus \ref{Equilibre:2}, we determine that the Equilibrium point is the following one : 
	
	\begin{align*}
		\boxed{d_1^* = -\frac{V_2}{\alpha_2}\ln \left(\frac{V_2-V_1}{V_2}e^{-\frac{\alpha_2}{V_2}d_2} \right)}
	\end{align*}
	
	The challenge with this equation is the inability to find an analytical solution. Consequently, we apply Lyapunov's Indirect Theorem to investigate the equilibrium. In the context of 1D analysis, we begin by calculating $f'(d_1, t)$, which results in:
	
	\[
		\boxed{f'(d_1, t) = -\alpha_2e^{-\frac{\alpha_2}{V_2}(d_1 - d_{2}^{sec})}}
		\]
	
	It is evident that $f'(d_1, t)$ is negative for all values of $\alpha_2$ greater than zero. Therefore, in our specific scenario, the equilibrium remains stable at all times, as negative acceleration is not considered.
	
	From the equilibrium, we also observe that the equilibrium exists if and only if $V_2 > V_1$.
	
	Clearly, the condition for a stable equilibrium is $\alpha_2 > 0$ and $V_2 > V_1$.
	

	
	\begin{figure}[H]
		\centering
		\begin{subfigure}{0.54\textwidth}
			\centering
			\includegraphics[width=\linewidth]{VectorFIeld.png}
		\end{subfigure}
		\hfill
		\begin{subfigure}{0.44\textwidth}
			\centering
			\includegraphics[width=\linewidth]{RealSolModif.png}
		\end{subfigure}
		\caption[Visualisation of the equilibrium]{\textbf{\underline{Visualisation of the equilibrium:}} On the left figure, you could see the vector field that converges onto the equilibrium point. On the right, the Approximation of the real Solutions of the system of ODEs.}
		\label{fig:SE3}
	\end{figure}
	
		Graphically, this can be observed in Figure \ref{fig:SE3}. On the left side of the figure, the phenomenon of convergence towards equilibrium can be demonstrated when the previously performed conditions are adhered to.
	
	On the right, we show the approximate solutions (Euler-Explicit) of the equation system given by the Newell model. We can see that, over time, the distance between the two cars reaches a constant value, corresponding to the equilibrium observed in the figure on the left. \newline\newline
	
	\textbf{\underline{The Study of the equilibrium for three cars : }} \newline\newline
	
	In the case of three cars, we obtain the following system of equations:
	
	
	\begin{align*}
		&\begin{cases}
			\begin{aligned}
				&\dot{d_1}(t) = \dot{x_1}(t) - \dot{x_2}(t) = V_1 - V_2 + V_2 \cdot e^{-\frac{\alpha_2}{V_2}(d_1 - d_{2}^{sec})} = f(d_1, t), \\
				&\dot{d_2}(t) = \dot{x_2}(t)-\dot{x_3}(t) = V_2 - V_2 \cdot e^{-\frac{\alpha_2}{V_2}(d_1 - d_{2}^{sec})} - V_3 + V_3 \cdot e^{-\frac{\alpha_3}{V_3}(d_2 - d_{3}^{sec})}
			\end{aligned}
		\end{cases}
		 \\ \\
		 \text{Where : } \\ \\
		&\left\{
		\begin{aligned}
			V_1 &:= \text{Maximum speed for car number 1}, \\
			V_2 &:= \text{Maximum speed for car number 2}, \\
			\alpha_i &:= \text{capacity of acceleration for car number i}, \\
			d_{i}^{sec} &:= \text{security distance that car number i maintains}.
		\end{aligned}
		\right.
	\end{align*}
	
	By using the same method as for the simulation with two cars, we could find that the equilibrium follows the following formula :
	\begin{align*}
		d_1^* &= -\frac{V_2}{\lambda_2}\ln \left(\frac{V_2-V_1}{V_2}e^{-\frac{\alpha_2}{V_2}d_2} \right) \\
		d_2^* &= -\frac{V_3}{\alpha_3}\ln \left(\frac{-V_3+V_2-V_2e^{\frac{-\alpha_2}{V_2}d_1}e^{\frac{\alpha_2}{V_2}d_2^{sec}}}{-V_3}e^{-\alpha_3 d_3^{sec}} \right)
	\end{align*}
	
	

	
	\begin{align*}
	\boxed{	J_{\bar{d}}=\begin{pmatrix}
			-\alpha_2e^{-\frac{\alpha_2}{V_2}(d_1 - d_{2}^{sec})} & 0 & \\
			\alpha_2e^{-\frac{\alpha_2}{V_2}(d_1 - d_{2}^{sec})} & -\alpha_3e^{-\frac{\alpha_3}{V_3}(d_2 - d_{3}^{sec})} &
	\end{pmatrix}}
	\end{align*}
	
	However, in the 2D case, Lyapunov tells us that the equilibrium is stable if:
	
	\[
	\boxed{
		\begin{aligned}
			Tr(J_{\bar{d}}) &< 0 \\
			\det(J_{\bar{d}}) &> 0
		\end{aligned}
	}
	\]

	The both condition are respected iff $\lambda_2>0, \lambda_3>0$
	 \newline\newline
	 
	In the case of two cars, if the conditions are met, convergence to the equilibrium point can be observed graphically. As the equations apply uniformly to all cars, equilibrium exists under the same conditions, even for the nth car.
	
	In figure \ref{fig:SE4}, the equilibrium point is represented by coordinates corresponding to the equilibrium distance between cars 2 and 3 on the $d_2$ axis, and between cars 1 and 2 on the $d_1$ axis. This distance, as in other cases, can be found on figure \ref{fig:SE5} by calculating the difference between the positions of the cars. As in the previous scenario, the solution plotted is not the real solution but an approximation using Euler's explicit method because it is impossible to obtain an analytical solution.
	 
	 
	 \begin{figure}[H]
	 	\centering
	 	\includegraphics[width=0.5\textwidth]{VectorField1.png}
	 	\caption[Field Of Vector for the Newell's Model (Stability):]{\textbf{\underline{Field Of Vector for the Newell's Model (Stability):}} On this figure, you could see the field of vectors that converges from the equilibrium.}
	 	\label{fig:SE4}
	 \end{figure}
	 
	 
	 \begin{figure}[H]
	 	\centering
	 	\includegraphics[width=0.8\textwidth]{RealSol1.png}
	 	\caption[Approximation of the real solution for the Newell's Model (Stability)]{\textbf{\underline{Approximation of the real solution for the Newell's Model (Stability): }} On this figure, you could see the distance between the curves that converges.}
	 	\label{fig:SE5}
	 \end{figure}
	
	
	
	\section{Types of Simulations Performed with PDE models}
	
	In this section, the objective is to demonstrate an alternative method for simulating traffic flow on roads. To achieve this, we will employ PDEs, considering traffic flow as analogous to fluid dynamics.
	
	We conduct these simulations using the FDM with two types of models: the Euler Explicit and Lax-Friedrichs models. The Euler Explicit model demonstrates the simulation with free-flowing traffic, while the Lax-Friedrichs model depicts congested traffic scenarios.
	
	We are going to see why we don't do the same simulation with the two models in following part.
	
	
	\subsection{Simulation Performed with Euler Explicit Model}
	
	For the simulation in this section, we have decided to utilize the equation \ref{eq:PDE}, incorporating the following initial function and discretization:
	
	\[
	\boxed{
		\begin{aligned}
			&\rho_0(x)=0.2 \cdot \sin\left(2 \cdot \pi \cdot \frac{x}{L}\right) + 0.3 \\
			&\Delta t = 0.01 \\
			&\Delta x = 1
		\end{aligned}
	}
	\]
	
	We selected specific parameters for distinct reasons. The function $\rho_0(x)$ was chosen because it allows us to observe a particular phenomenon: the emergence of density peaks and the formation as well as movement of a 'traffic flow.' However, after completing the simulation, we noticed an instability in the solution for any time step, even those infinitesimally small, in one specific case.
	
	Empirical observation revealed that instability occurs when the density surpasses 0.5, indicating that the traffic flow reaches half of its capacity. To maintain stability, we constrained the function within the range of $[0, 0.5]$ by employing a coefficient of 0.2 and adding 0.3.
	
	We settled on a time step of 0.01, as it provides sufficient precision without imposing excessive resource demands. As for the time interval, we opted for one unit to observe the evolution at each meter.
	
	Finally we decide to plot the solutions under two forms. The first is a Density Map, and the second is an animations that you could saw on the GitHub Link.
	
	\begin{figure}[H]
		\centering
		\includegraphics[width=0.65\textwidth]{traffic_flow_density_map.png}
		\caption[Traffic Flow Simulation With Euler Explicit]{\textbf{\underline{Traffic Flow Simulation With Euler Explicit Method:}} This figure illustrates the solution of the PDE at any time and position. The pattern of the density peak is repeated due to boundary conditions (BC). We observe a diffusion effect in the model and the movement of traffic. }
		\label{fig:traffic_flow_density_map}
	\end{figure}
	
	
	\begin{figure}[H]
		\centering
		\begin{subfigure}{0.4\textwidth}
			\centering
			\includegraphics[width=\textwidth]{AniE1.jpg}
			\caption{T=0.240}
			\label{fig:graph1}
		\end{subfigure}
		\begin{subfigure}{0.4\textwidth}
			\centering
			\includegraphics[width=\textwidth]{AniE2.jpg}
			\caption{T=1.260}
			\label{fig:graph2}
		\end{subfigure}
		
		\vspace{0.5cm}
		
		\begin{subfigure}{0.4\textwidth}
			\centering
			\includegraphics[width=\textwidth]{AniE3.jpg}
			\caption{T=2.470}
			\label{fig:graph3}
		\end{subfigure}
		\begin{subfigure}{0.4\textwidth}
			\centering
			\includegraphics[width=\textwidth]{AniE4.jpg}
			\caption{T=5.400}
			\label{fig:graph4}
		\end{subfigure}
		\caption[Graph of the Movement of the Traffic Flow]{\textbf{\underline{Graph of the Movement of the Traffic Flow:}} On this graph, you can see that the Traffic Flow is moving forward and that the information is propagating over time. There is the link to see the animation : \href{https://github.com/FlorentGerbaud/Simple-road-traffic-modeling/blob/Flo-PDE/SRTM/EDPMethod/CasTestToLaunch/TestToLaunch/Modele_IC_S/EulerExplicit/traffic_flow_animation.gif}{\textbf{\underline{Traffic Flow Simulation}}}}
		\label{fig:four_graphs}
	\end{figure}
	These two graphs are very interesting because we can observe some phenomena. 
	\newline\newline\textbf{\underline{Diffusivity of the Model :}} The first phenomenon is the diffusive nature concerning the model. In fact, on Figure \ref{fig:traffic_flow_density_map}, you can see that each time the peak of density appears, the density of drivers decreases. On Figure \ref{fig:four_graphs}, this becomes evident as the solution to the equation diminishes progressively. If we continue the simulation for a longer period, we will observe the curve collapsing.
	\newline\newline
	\textbf{\underline{The Propagation of Density Over Time :}} We can observe in Figure \ref{fig:traffic_flow_density_map} that density propagates both temporally and spatially. For instance, the initial peak of density begins at 0 meters and time 0, extending to 100 meters by 6 seconds. In the animation, you can also observe the movement of the peak. In Figure \ref{fig:four_graphs} , we witness the peak moving from 20 to 90 meters in approximately 5.5 seconds, as indicated by the Density map.
	\newline\newline
	\textbf{\underline{Creation of Peaks of Density :}}
	The last phenomenon that we can observe is the creation of peaks of density. In fact, in the animation, you can see that when the density is relatively low, a peak is formed. This phenomenon occurs because when the density is lower, cars tend to travel faster, catching up with the cars already in a peak of density. So they need to slow down and it is for this reason that we could observe this peak.
	\newline\newline
	\textbf{\underline{Limit of this model :}}
	However, as discussed previously, we encounter a problem with this model. The limitation of this model is that for a density greater than 0.5, the model becomes unstable. Therefore, we need to utilize another model, the Lax-Friedrichs Model. This model is slightly more complex but resolves the issue of instability. With Jim's assistance, we will explore the behavior of high density scenarios.
	\subsection{Simulation Performed with Lax-Friedrichs Model}
	
	For the simulation in this section, we have decided to utilize the equation \ref{eq:PDE}, incorporating the following initial function and discretization:
	
	\[
	\boxed{
		\begin{aligned}
			&\rho_0(x)=0.2 \cdot \sin\left(2 \cdot \pi \cdot \frac{x}{L}\right) + 0.8 \\
			&\Delta t = 0.01 \\
			&\Delta x = 1
		\end{aligned}
	}
	\]
	
	As we observed earlier, the model was unable to accurately simulate high density. Consequently, the aim now is to accurately simulate this particular scenario. To do this, in the function $\rho_0(x)$, the inclusion of a coefficient of 0.8 ensures that the function, represents a high density for the initial conditions, allowing us to simulate this new phenomenon. For the time step and space step, we have opted for values identical to those used in the previous Euler Explicite method, for the same underlying reasons. Finally, we have chosen to represent the solutions in two different forms. The first form is a density map, while the second is an animation that can be viewed via the GitHub link provided.
	
	\begin{figure}[H]
		\centering
		\includegraphics[width=0.65\textwidth]{traffic_flow_density_map_LF.png}
		\caption[Traffic Flow Simulation With Euler Explicit]{\textbf{\underline{Traffic Flow Simulation With Euler Explicit:}} This figure illustrates the solution of the PDE at any time and position. You can notice that the peak of density is set back. The model exhibits both diffusive and dispersive properties. The periodic boundary conditions allow the phenomenon to repeat over time.}
		\label{fig:traffic_flow_density_map_LF}
	\end{figure}
	
	
	\begin{figure}[H]
		\centering
		\begin{subfigure}{0.4\textwidth}
			\centering
			\includegraphics[width=\textwidth]{AniE1_LF.jpg}
			\caption{T=1.740}
			\label{fig:1740}
		\end{subfigure}
		\begin{subfigure}{0.4\textwidth}
			\centering
			\includegraphics[width=\textwidth]{AniE2_LF.jpg}
			\caption{T=2.790}
			\label{fig:2790}
		\end{subfigure}
		
		\vspace{0.5cm}
		
		\begin{subfigure}{0.4\textwidth}
			\centering
			\includegraphics[width=\textwidth]{AniE3_LF.jpg}
			\caption{T=4.380}
			\label{fig:4380}
		\end{subfigure}
		\begin{subfigure}{0.4\textwidth}
			\centering
			\includegraphics[width=\textwidth]{AniE4_LF.jpg}
			\caption{T=9.220}
			\label{fig:9220}
		\end{subfigure}
		\caption[Graph of the Movement of the Traffic Flow]{\textbf{\underline{Graph of the Movement of the Traffic Flow:}} On this graph, you can see that the Traffic Flow is moving backwards and that the information is propagating over time. There is the link to see the animation : \href{https://github.com/FlorentGerbaud/Simple-road-traffic-modeling/blob/Flo-PDE/SRTM/EDPMethod/CasTestToLaunch/TestToLaunch/Modele_IC_S/LaxFriedrichs/traffic_flow_animation.gif}{\textbf{\underline{Traffic Flow Simulation}}}}
		\label{fig:GraphLF}
	\end{figure}
	\begin{figure}[H]
		\centering
		\includegraphics[width=0.5\textwidth]{AniE5_LF.jpg}
		\caption[scheme dispersivity]{This graph allows to highlight  the oscillation of the graph that show the dispersivity of the scheme}
		\label{fig:Dis}
	\end{figure}
	
	This simulation is quite intriguing because despite some similarities with the previous one, we observed several interesting phenomena.\\ \\ \textbf{\underline{Diffusivity and Dispersivity of the Model :}}
	The first two phenomena pertain to the scheme itself. As depicted in Figure \ref{fig:traffic_flow_density_map_LF} and in Simulation \ref{fig:GraphLF}, the density decreases over time and space. This illustrates that the scheme is a diffusive model. Furthermore, the animation \ref{fig:Dis} also demonstrates oscillations in the curve towards the end of the simulation. These oscillations may be explained by the model also being a dispersive one. Hence, we can conclude that this scheme might not be well-suited for this type of equation. Nevertheless, for short simulations like the ones we conducted, this is not problematic. \\ \\
	\textbf{\underline{Creation of Peaks of Density :}} The second notable phenomenon is similar to the Euler-Explicit method: the formation of traffic jams. Observing the animation, each time the density is lower than the maximum density, a traffic jam reappears. This occurrence could be explained by cars accelerating when the density decreases. However, they catch up with the car in front of them, resulting in a traffic jam. \\ \\ \textbf{\underline{Receding Traffic Jam : }} Finally, the most intriguing phenomenon is the appearance of upside-down traffic jams. In the animation, we can see the curves moving from right to left. if you look the DensityMap, at time t=0, the maximum density is between 15m and 35m. However, at t=1, the maximum density moves towards 0m. This backward movement can be explained by the fact that people at the head of the traffic jam can accelerate, as it's the end of the jam. Conversely, those at the rear of the traffic jam become the tail end. After a while, they become the head of the traffic jam and can accelerate out of it.
	\section{Summary}
	
	This project was a great and enriching experience in both human and scholarly aspects. Humanly, we learned and strengthened our teamwork, collaborated, communicated, sought help, and leveraged each other's competencies when needed. From an academic perspective, we were able to apply our new knowledge in Partial Differential Equations (PDEs) and Ordinary Differential Equations (ODEs) to practical scenarios, comprehending new phenomena. Additionally, we improved our English proficiency as the entire project was conducted in English. We learned to adapt to situations where progress may not always be swift, to write efficient code, grasp new concepts through research and collaborative efforts, and utilize Git effectively.
	
	Moreover, the Project's subject was captivating as it provided extensive learning about road traffic simulations and their study, contributing to a better understanding of fluid mechanics due to their interconnectedness. It also helped affirm or reconsider our specialization choices for our final year at Polytech.
	
	This report contains only a few graphics. If you wish to view more visuals or access the code, I invite you to visit the GitHub Project \cite{SMRT}.
	\newpage
	\section{Annexe}
	
	\subsection{Calculation of the Analytical solutions}
	
	\subsubsection{Linear Model for Two Cars}
	
	\label{eq:EDO1}
	\begin{align*} 
		\dot{d_1}(t) = V_1 - \alpha_2 \cdot d_1
	\end{align*}
	We use the variable separation method to Solve this EDO, so we obtain : 
	\begin{align*} 
		&\int_{x(t_0)}^{x(t_f)} \frac{1}{V_1 - \alpha_2 \cdot d_1(t)} d \ d_1(t) = \int_{t_0}^{t_f} dt \\
		&-\frac{1}{\lambda_2} \left[ \ln\left| V_1 - \alpha_2 \cdot d_1(t) \right| \right]_{x(t_0)}^{x(t_f)} = t_f-t_0 \\
		&-\frac{1}{\lambda_2} \ln\left| \frac{V_1 - \alpha_2 \cdot d_1(t_f)}{V_1 - \alpha_2 \cdot d_1(t_0)} \right| = t_f-t_0
	\end{align*}
	We could remove the |.| because the sign is always the same. And we get : 
	
	\begin{align*}
		&\ln\left( \frac{V_1 - \alpha_2 \cdot d_1(t_f)}{V_1 - \alpha_2 \cdot d_1(t_0)} \right)  = -\lambda_2( t_f-t_0)\\
		&\frac{V_1 - \alpha_2 \cdot d_1(t_f)}{V_1 - \alpha_2 \cdot d_1(t_0)}  = e^{-\lambda_2( t_f-t_0)} \\
		&V_1 - \alpha_2 \cdot d_1(t_f)   = (V_1 - \alpha_2 \cdot d_1(t_0))e^{-\lambda_2( t_f-t_0)} \\
		&\boxed{
			d_1(t) = \frac{V_1 - [V_1 - \alpha_2 \cdot d_1(t_0)]e^{-\lambda_2( t_f-t_0)}}{\alpha_2}
		}
	\end{align*}

	\subsubsection{Linear Model for Three Cars}
	\label{eq:EDO2}
	The system under matricial form coul be write like that :
	
	\begin{align*}
		\dot{D}=(t)\begin{pmatrix}
			-\alpha_2 & 0 \\
			\alpha_2 & -\alpha_3
		\end{pmatrix}
		\begin{pmatrix}
			d_1 \\
			d_2
		\end{pmatrix} + 
		\begin{pmatrix}
			V_1 \\
			0
		\end{pmatrix}
	\end{align*}
	
	The first step is to perfom the eigenvectors of the matrix:
	
	\begin{align*}
		\begin{vmatrix}
			X+\alpha_2 & 0 \\
			\alpha_2 & X+\alpha_3
		\end{vmatrix} = (X+\alpha_2)(X+\alpha_3=X^2+X(\alpha_3+\alpha_2)+\alpha_2\alpha_3
	\end{align*}
	by simple resolution of the second order polynomial, we could fin two eigenvalues: \newline
	$\lambda_1=-\alpha_2, \lambda_2 = -\alpha_3$
	we looking for the two eigen vectors : 
	
	\[
	\begin{cases}
		\begin{bmatrix}
			0 & 0 & | & 0 \\
			\alpha_2 & -\alpha_3 + \alpha_2 & | & 0
		\end{bmatrix} \\ \\
		\begin{bmatrix}
			-\alpha_2 + \alpha_3 & 0 & | & 0 \\
			\alpha_2 & 0 & | & 0
		\end{bmatrix}
	\end{cases}
	\]
	
	It is easy to see that the two following vector are vector that verify the condition : 
	
	\[
	\begin{cases}
		u_1=\begin{pmatrix}
			1 \\
			\frac{\alpha_3-\alpha_2}{\alpha_2}
		\end{pmatrix} \\ \\
		u_2=\begin{pmatrix}
			0 \\
			1
		\end{pmatrix}
	\end{cases}
	\]
	
	Then, we know that a general solution of the equation is : 
	\begin{align*}
		&\bar{D}
		(t) = \sum_{i=1}^2 X_i \\
		&\text{where } X_i = C_i e^{\lambda_it} u_i, \\
		&\text{with } C_i \text{ being constants to be determined, and } u_i \text{ as the eigenvectors}, \textbf{and} \lambda_i \textbf{the eigenvalues}.
	\end{align*}
	
	So : 
	\begin{align*}
		X_1=\begin{pmatrix}
			\frac{C_1(\alpha_3-\alpha_2)}{\alpha_2e^{\alpha_2t}} \\ \\
			\frac{C_1}{e^{\alpha_2t}}
		\end{pmatrix} \\ \\ 
		X_2=\begin{pmatrix}
			0 \\
			\frac{C_2}{e^{\alpha_3 \cdot t}}
		\end{pmatrix}
	\end{align*}
	
	Finally the general solution is given by : 
	
	\begin{align*}
		\bar{X}
		=\begin{pmatrix}
			\frac{C_1(\alpha_3-\alpha_2)}{\alpha_2e^{\alpha_2t}} \\ \\
			\frac{C_1}{e^{\alpha_2t}} + \frac{C_2}{e^{\alpha_3 \cdot t}}
		\end{pmatrix} \\ \\ 
	\end{align*}
	
	Then we are going to find for particular solution : 
	
	
	\begin{align*}
		\begin{cases}
			\dot{d_1} &= 0 \\
			\dot{d_2} &= 0
		\end{cases} \iff 
		\begin{cases}
			d_1^* &= \frac{V_1}{\alpha_2} \\
			d_2^* &= \frac{V_1}{\alpha_3}
		\end{cases}
	\end{align*}
	
	In clear, we have : 
	\begin{align*}
		\begin{cases}
			d_1(t) &= \frac{C_1(\alpha_3-\alpha_2)}{\alpha_2e^{\alpha_2t}}+ \frac{V_1}{\alpha_2}\\
			d_2(t) &= \frac{C_1}{e^{\alpha_2t}} + \frac{C_2}{e^{\alpha_3 \cdot t}} + \frac{V_1}{\alpha_3}
		\end{cases}
	\end{align*}
	
	we set the initial condition to \newline 
	$d_1(0)=m, d_2(0)=n$ So we find easily $C_1 and C_2$ : 
	\begin{align*}
		&C_1=\frac{m\alpha_2-V_1}{\alpha_3-\alpha_2} \\
		&C_2=n-\frac{V_1}{\alpha_3} - C_1
	\end{align*}
	
	\subsection{Calculation of the Equilibrium point}
	\subsubsection{Newell's Method for two cars} \label{Equilibre:2}
	\begin{align*}
		V_1 - V_2 + V_2 \cdot e^{-\frac{\alpha_2}{V_2}(d_1 - d_{2}^{sec})} &= 0 \\
		e^{-\frac{\alpha_2}{V_2}(d_1 - d_{2}^{sec})} &= \frac{V_2-V_1}{V_2} \\
		e^{-\frac{\alpha_2}{V_2}d_1} &= \frac{V_2-V_1}{V_2}e^{-\frac{\alpha_2}{V_2}d_2} \\
		-\frac{\alpha_2}{V_2}d_1 &= \ln \left(\frac{V_2-V_1}{V_2}e^{-\frac{\alpha_2}{V_2}d_2} \right) \\
		d_1^* &= -\frac{V_2}{\alpha_2}\ln \left(\frac{V_2-V_1}{V_2}e^{-\frac{\alpha_2}{V_2}d_2} \right)
	\end{align*}
	
	\subsubsection{Newell's Method for three cars}
	
	\begin{align*}
		&\dot{d_2}=V_2-V_2e^{\frac{-\alpha_2}{V_2}d_1}e^{\frac{\alpha_2}{V_2}d_2^{sec}}-V_3+V_3e^{\frac{-\alpha_3}{V_3}d_2}e^{\frac{\alpha_3}{V_3}d_2^{ sec}} \\
		&\dot{d_2}=0 \\
		&V_2-V_2e^{\frac{-\alpha_2}{V_2}d_1+\frac{\alpha_2}{V_2}d_2^{sec}}-V_3+V_3e^{\frac{-\alpha_3}{V_3}d_2+\frac{\alpha_3}{V_3}d_3^{sec}} \\
		&\frac{V_2-V_2e^{\frac{-\alpha_2}{V_2}d_1+\frac{\alpha_2}{V_2}d_2^{sec}}-V_3}{-V_3}=e^{\frac{-\alpha_3}{V_3}d_2+\frac{\alpha_3}{V_3}d_3^{sec}} \\
		&\frac{V_2-V_2e^{\frac{-\alpha_2}{V_2}d_1+\frac{\alpha_2}{V_2}d_2^{sec}}-V_3}{-V_3}e^{\frac{-\alpha_3}{V_3}d_3^{sec}} =e^{\frac{-\alpha_3}{V_3}d_2} \\
		&d_2^* = -\frac{V_3}{\alpha_3}\ln \left(\frac{-V_3+V_2-V_2e^{\frac{-\alpha_2}{V_2}d_1}e^{\frac{\alpha_2}{V_2}d_2^{sec}}}{-V_3}e^{-\alpha_3 d_3^{sec}} \right)
	\end{align*}
	
	
	\newpage
	
	%\bibliographystyle{plain}
	\printbibliography
	%\bibliography{Rapport}
\end{document}