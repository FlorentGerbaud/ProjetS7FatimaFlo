\documentclass{article}
\usepackage[backend=biber, style=authoryear, sorting=nyt, style=numeric]{biblatex}
\usepackage{url}
\usepackage[dvipsnames]{xcolor}
\usepackage{enumitem}

\usepackage{background}
\usepackage{tikz}
\usepackage{geometry}
\usetikzlibrary{shapes, arrows, positioning}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[british]{babel}
\usepackage{titletoc}
\usepackage{titlesec}
\usepackage{lipsum}
\usepackage{tocloft}
\usepackage{hyperref}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{graphicx}
\usepackage[section]{placeins}
\usepackage{caption}
\usepackage{textcomp}
\usepackage{subcaption}
\usepackage[edges]{forest}
%\usepackage[superscript,biblabel]{cite}
\usepackage{fontawesome5}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{amsmath}
\usepackage[simplified]{pgf-umlcd}
\usepackage{enumitem}
\usepackage{adjustbox}
\usepackage{listings}
\usetikzlibrary{shapes.geometric, arrows}
%\usepackage[style=ext-authoryear, backend=biber]{biblatex}
%\usepackage{url}
%\usepackage[style=authoryear]{biblatex}
%\addbibresource{biblio.bib}
%\usepackage{cite}
\usepackage[british]{datetime2} % Enhanced date and time.

\addbibresource{rapport.bib}

\definecolor{aerospaceblue}{RGB}{0, 128, 255} % Couleur bleu ciel pour l'aérospatiale
\definecolor{myblue}{RGB}{0, 0, 255}

% Define the theme colors
\definecolor{blue}{RGB}{0,0,255}
\definecolor{green}{RGB}{0,128,0}
\definecolor{red}{RGB}{255,0,0}
\definecolor{custompurple}{RGB}{128,0,128}

% Set the lstset configuration
\lstset{
	language=C++,
	basicstyle=\ttfamily\small,
	keywordstyle=[1]\color{blue},
	keywordstyle=[2]\color{black},
	keywordstyle=[3]\color{green!60!black},
	commentstyle=\color{green!60!black},
	stringstyle=\color{red},
	otherkeywords={CALL},
	morekeywords=[1]{CALL},
	morekeywords=[2]{FOPENSUBNODES},
	numbers=left,
	numberstyle=\tiny,
	stepnumber=1,
	numbersep=5pt,
	frame=single,
	breaklines=true,
	breakatwhitespace=true,
	tabsize=4,
	captionpos=b,
	showstringspaces=false,
	% Adjust the frame margins for a larger rectangle
	xleftmargin=1em,
	framexleftmargin=1em,
	framexrightmargin=1em
}


\tikzset{
	startstop/.style={
		rectangle,
		rounded corners,
		minimum width=3cm,
		minimum height=1cm,
		text centered,
		draw=black,
		fill=red!30
	},
	io/.style={
		trapezium,
		trapezium stretches=true, % A later addition
		trapezium left angle=70,
		trapezium right angle=110,
		minimum width=3cm,
		minimum height=1cm,
		text centered,
		draw=black,
		fill=blue!30
	},
	process/.style={
		rectangle,
		minimum width=3cm,
		minimum height=1cm,
		text centered,
		text width=3cm,
		draw=black,
		fill=orange!30
	},
	decision/.style={
		diamond,
		minimum width=3cm,
		minimum height=1cm,
		text centered,
		draw=black,
		fill=green!30
	},
	arrow/.style={
		thick,
		->,
		>=stealth
	}
}

\newcommand{\coloredsquare}[1]{\textcolor{#1}{\rule{1em}{1em}}}

\renewcommand{\cfttoctitlefont}{\hfill\large\bfseries\fontsize{20}{24}\selectfont}
\renewcommand{\cftaftertoctitle}{\hfill\mbox{}}

\definecolor{mydarkyellow}{HTML}{87CEEB}
\definecolor{lightblue}{RGB}{173,216,230}
\definecolor{lightyellow}{RGB}{255,255,204}
\definecolor{yellow}{RGB}{255,255,0}

\backgroundsetup{
	scale=1,
	color=black,
	opacity=0.5,
	angle=0,
	contents={
		\ifnum\value{page}=1
		\begin{tikzpicture}[remember picture,overlay]
			\path [fill=mydarkyellow] (current page.south west) rectangle (current page.north east);
		\end{tikzpicture}
		\fi
	}
}

\title{\textbf{\Huge Project Report}\\[1cm]
	\textbf{\LARGE Polytech Nice}\\[2cm]
	\hrule height 1pt
	\vspace{0.5cm}
	\textbf{\Large Simple Road Traffic Modeling}\\[0.5cm]
	\hrule height 1pt
	\vspace{3cm}
	\small{\today{}}}

\author{
	\begin{tabular}{c}
		Gerbaud Florent \\ Fatima Rharrour \\ \\
		9-th october to 20-th December september 2023\\
		\\ Academic tutor : Didier Auroux
	\end{tabular}
}

\date{}
\begin{document}
	\maketitle
	\hspace{2cm}
	\begin{figure}[b]
		\centering
		\begin{minipage}[b]{0.45\linewidth}
			\includegraphics[width=5cm]{logo.png} \\
			%Company tutor : Vincent Vadez
		\end{minipage}
		\hfill
		\begin{minipage}[b]{0.45\linewidth}
			\raggedleft
			\vspace{-0.5cm}
			\includegraphics[width=6cm]{Polytech.png} \\
			%Academic tutor : Cédric Boulbe
		\end{minipage}
	\end{figure}
	\newpage % ajout d'un saut de page
	% Table des matières
	\renewcommand{\contentsname}{
		\hfill
		\begin{tikzpicture}
			\node[draw, fill=white, inner sep=20pt,line width=1.5pt] {\fontsize{30}{36}\selectfont\bfseries Table of Contents};
		\end{tikzpicture}
		\hfill
	}
	\tableofcontents
	\newpage
	\listoffigures % Add a listing of figures
	
	\listofalgorithms
	\newpage
	\section{Presentation of the Subject}
	\subsection{Useful Definition}
		\textbf{\underline{Ordinary Differential Equation (ODE):}} \newline\newline
		An ODE is a mathematical equation that relates a function to its derivatives with respect to one or more independent variables. ODEs are commonly represented given a function F of x, y, and derivatives of y. Then, an equation of the form
		\begin{align*}
			F\left(x,y,y',\ldots ,y^{(n-1)}\right)=y^{(n)}
		\end{align*}
		
		\textbf{\underline{What is Road Traffic Modeling}} \newline\newline
		The Road Traffic modeling  is the study of how vehicles behave on road networks, aiming to simulate and analyze various aspects of traffic flow, congestion, and driver behavior. This field involves creating mathematical and computer models to understand and predict traffic patterns, particularly in scenarios such as congestion, erratic driving, and other relevant factors affecting road transportation. Road traffic modeling plays a crucial role in urban planning, traffic management, and the development of intelligent transportation systems (you could see an exemple on the \ref{fig:intro}).

	\begin{figure}[H]
		\centering
		\includegraphics[width=0.8\textwidth]{intro.jpg}
		\caption{\textbf{\underline{Road traffic : }} In this picture, you can see an example of a road traffic phenomenon that we could study}
		\label{fig:intro}
	\end{figure}
	
	\subsubsection{Simple Road Traffic Modeling}
	
		Here explain what is the objective how we are going to do the study and so on
	
	\subsubsection{Using GitHub for Project Management}
	
	\begin{figure}[H]
		\centering
		\includegraphics[width=0.8\textwidth]{GitHub.jpg}
		\caption{\textbf{\underline{Road traffic : }} In this picture, you can see an example of a road traffic phenomenon that we could study}
		\label{fig:GitHub}
	\end{figure}
	
	\section{The equation for SMRT}
		\subsection{Differential Ordinary Equation }
		In this part, the idea is to resolve two types of systems of Ordinary Differential Equations (ODEs) that allow us to simulate traffic flow. To achieve this, we will use the Euler Explicit method to numerically solve the solutions.
		The Euler Explicit method is given by the folowing eqution :
		\begin{itemize}
			\item EDO to solve: $\boxed{y'(t) = f{\bigl (}t, y(t){\bigr )}}$.
			\item First step of the resolution: $\boxed{y_0 = y(t_0)}$.
			\item Recursive process to find the n-th solution of the EDO: $\boxed{y_{n+1} = y_{n} + hf(t_{n}, y_{n})}$
		\end{itemize}
		
		
		
		
		
		\subsubsection{Linear Model}
			\textbf{\underline{Mathematical Theory:}}
			\newline
			
			In this section, we're going to explain the math behind our model for understanding how cars behave in traffic. To make things simple, we use a discrete model, which means we look at cars one at a time and how they interact on the road.
			
			Each car's movement is governed by a basic equation:
			
			\begin{align*}
				\dot{x_i}(t) = V_i = \alpha_i(x_{i-1} - x_i)
			\end{align*}
			
			In this equation, \(x_i(t)\) represents where the \(i\)-th car is at a given time, \(V_i\) is how fast the \(i\)-th car is going, and \(\alpha_i\) is a number that describes how that car behaves. The right side of the equation, \(\alpha_i(x_{i-1} - x_i)\), tells us how the car's speed changes based on how close it is to the car in front.
			
			When we put this equation to work for all the cars, we end up with a bunch of equations (one for each car), which helps us understand how they all move together in traffic. These equations give us a dynamic view of how cars influence each other as they drive.
			
			The system of equations is written like this for each car, where \(i\) can be 1, 2, and so on, up to the number of cars:
			
			\begin{align*}
				\left\{
				\begin{array}{ll}
					\dot{x}_1 &= V_1 \\
					\dot{x}_2(t) &= \alpha_2(x_1 - x_2) \\
					&\vdots \\
					\dot{x}_n(t) &= \alpha_n(x_{n-1} - x_n)
				\end{array}
				\right.
			\end{align*}
			
			These equations help us understand how traffic flows and how individual cars influence one another on the road.
			
			In the first part of the study, we consider $\alpha_i$ as a constant. However, in the next part of the simulation, we define some functions $\alpha_i(t)$.
			
			In fact, we have three types of simulations:
			
			1. \textbf{\underline{Constant value:}}
			\[
			\alpha_i(t) = C_i
			\]
			
			2. \textbf{\underline{Sinusoidal with noise:}}
			\[
			\alpha_i(t) = \left| W \cdot \sin(\omega t + \phi) + \mathcal{N}(0, 0.1) \right|
			\]
			
			3. \textbf{\underline{Stochastic Driver Model:}} \newline \newline
			Consider a random driver model with an output labeled as \( \alpha_i(t) \), which relies on various factors like the average, spread, and time \( t \). This model produces a random noise part from a usual distribution with an average and spread of \( \sqrt{\text{spread}} \). If a limit is given, the generated noise is confined within the interval \([- \text{limit}, \text{limit}]\). \newline \newline
			
			\textbf{Mathematically, we can express this as:}
		
			
			\[
			\alpha_i(t) =
			\begin{cases}
				\left| \mathcal{N}(\text{average}, \sqrt{\text{spread}}) \right|, & \text{if } -\text{limit} \leq \alpha_i(t) \leq \text{limit}, \\
				-\text{limit}, & \text{if } \alpha_i(t) < -\text{limit}, \\
				\text{limit}, & \text{if } \alpha_i(t) > \text{limit}.
			\end{cases}
			\]
			
			Here, \( \text{average} \) signifies the mean of the acceleration, and \( \text{spread} \) stands for the acceleration's spread. The limit is defined to prevent or create specific situations, like accidents, depending on the desired result. \\
			
			
			\textbf{\underline{Implementation : }}
			
			\begin{algorithm}[H]
				\caption{$\dot{x_1}$}\label{alg:x1_dot}
				\begin{algorithmic}
					%\State \textbf{Input:} \\
					%\begin{itemize}
						%\State $P_1,P_2,P_3,:=\text{"the 3 first vertex of the 2D mesh"}$
					%\end{itemize}
					\State \textbf{Output:} \\
					\begin{itemize}[]
						\item $\dot{x_1}=V_1$
					\end{itemize}
					\State \textbf{Algorithm:} \\
					\begin{itemize}[]
						\State $\dot{x_1}=130 \times \frac{1000}{3600}$ 
						\State \Return $\dot{x_1}$ 
					\end{itemize}		
				\end{algorithmic}
			\end{algorithm}
			
			\begin{algorithm}[H]
				\caption{$\dot{x_i}$}\label{alg:xi_dot}
				\begin{algorithmic}
					\State \textbf{Input:} \\
					\begin{itemize}
					\State $t:=\text{"time  step"}$
					\State$x_i:=\text{Table of position for the i-th Car}$
					\State$x_{i-1}:=\text{Table of position for the (i-1)-th Car}$
					\end{itemize}
					\State \textbf{Output:} \\
					\begin{itemize}[]
						\item $\dot{x_i}=V_i$
					\end{itemize}
					\State \textbf{Algorithm:} \\
					\begin{itemize}[]
						\State $\dot{x_i}(t) = V_i = \alpha_i(x_{i-1}[t] - x_i[t])$ 
						\State \Return $\dot{x_i}$ 
					\end{itemize}		
				\end{algorithmic}
			\end{algorithm}
			
			This algorithm allows to define an orthonormed local reference frame and we delete the lines to eliminate for reducing matrix
			
			\begin{algorithm}[H]
				\caption{sinusoidal\_model}\label{alg:sinusoidal_model}
				\begin{algorithmic}
					\State \textbf{Input:} \\
					\begin{itemize}
						\State $W := \text{"Amplitude of the perturbation"}$
						\State $\omega := \text{"Angular frequency"}$
						\State $t := \text{"time"}$
						\State $\phi := \text{"Phase (in radians)"}$
					\end{itemize}
					\State \textbf{Output:} \\
					\begin{itemize}
						\item This function returns a value of acceleration $(\alpha_i(t))$ following a sinusoidal model with random noise.
					\end{itemize}
					
					\State \textbf{Algorithm:} \\
					\begin{itemize}
						\State $ \alpha_i(t) = \left| W \cdot \sin(\omega \cdot t + \phi) + N \right|$ 
						\State \text{$N$:="random noise such as N $\sim$ $\mathcal{N}(0,0.01)$"}
						\State \Return $\alpha_i(t)$
					\end{itemize}
				\end{algorithmic}
			\end{algorithm}
			
			
		\subsubsection{Newell's Model}
		\subsection{Partial Differential Equations}
		
	\section{Project Objectives}
	\subsection{Problems Encountered}
	
	\section{Types of Simulations Performed}
		\subsection{Simulation with Drunk Drivers}
		\subsection{Simulation with Unpredictable Drivers}
		\subsection{Simulation with Drivers Reacting Similarly}
		\subsection{Study of Equilibrium, Stability, and Instability of the Solution}
		\subsubsection{System Stability and Equilibrium for the Linear Model}
		In this part, the idea is to study the distance difference between two cars in order to determine in which case the solutions is stable and if there is an equilibrium for the solution.
		For doing that, we studied the solutions of the following  system of equation : 
		\begin{align*}
			\begin{cases}
				\dot{d_1} &= V_1 - \alpha_2 \cdot d_1 \\
				&\vdots \\
				\dot{d_n} &= \alpha_n \cdot d_{n-1} - \alpha_{n+1} \cdot d_n
			\end{cases}
		\end{align*}
		
		So, In our context, for the two cars, we have a 1D system. With 3 cars, we have a 2D system of equations.
		
		Now talk about the system stability and equilibrium : 
		\newline \newline \textbf{\underline{With 2 cars}} : \newline\newline
	
		So, the equation to study is the following one : 
		
		\begin{align*}
			\dot{d_1} &= V_1 - \alpha_2 \cdot d_1
		\end{align*}
		
		
		After the resolution (cf Annexe clique figure ) we obtain the next equation for $d_1(t)$ : 
		\begin{align*}
			\boxed{d_1(t) = \frac{{V_1 - V_1 \cdot e^{-\alpha_2(t-t_0)} + \alpha_2 \cdot d_1(t_0) \cdot e^{-\alpha_2(t-t_0)}}}{\alpha_2}}
		\end{align*}
		
		The first intuition before seeing the equation was to think that when the $\alpha_2 < 0 $, the solution is divergent because one car is go back and the other go forward. Now, if we study the Equation,
		
		the terms $V_1$ and $\alpha_2 \cdot d_1(t_0)$ are constant so they are not interesting.
		
		However, it's important to note that both terms, $e^{-\alpha_2(t-t_0)}$, are exponential functions of time. If the value of $\alpha_2$ is negative, these exponentials will increase exponentially over time.
		
		So we could easily see that the equation is stable and converge onto the equilibrium $d_1(t)=\frac{V_1}{\alpha_2}$.
		
		graphically  we can see it by : 
		
		\begin{figure}[H]
			\centering
			\begin{minipage}[t]{0.50\linewidth}
				\centering
				\includegraphics[width=1.4\linewidth]{RealisticCase.png}
				\caption{View of the old window of temrec3D}
				\label{fig:OV}
			\end{minipage}
			\hfill
			\begin{minipage}[t]{0.50\linewidth}
				\centering
				\includegraphics[width=1.4\linewidth]{RealSolCase.png}
				\caption{View of the new window of temrec3D}
				\label{fig:NV}
			\end{minipage}
		\end{figure}
		
		\begin{figure}[H]
			\centering
			\begin{minipage}[t]{0.50\linewidth}
				\centering
				\includegraphics[width=1.4\linewidth]{Stability.png}
				\caption{View of the old window of temrec3D}
				\label{fig:OV}
			\end{minipage}
			\hfill
			\begin{minipage}[t]{0.50\linewidth}
				\centering
				\includegraphics[width=1.4\linewidth]{Unstability.png}
				\caption{View of the new window of temrec3D}
				\label{fig:NV}
			\end{minipage}
		\end{figure}
		
		\begin{figure}[H]
			\centering
			\includegraphics[width=0.8\textwidth]{FieldOfVector_CV.png}
			\caption{\textbf{\underline{Road traffic : }} In this picture, you can see an example of a road traffic phenomenon that we could study}
			\label{fig:GitHub}
		\end{figure}
		
	\section{Summary}
	
	\section{Annexe}
	
		
	
	%\bibliographystyle{plain}
	\printbibliography
	%\bibliography{Rapport}
\end{document}